!function(e){function t(t){for(var n,i,c=t[0],l=t[1],s=t[2],f=0,d=[];f<c.length;f++)i=c[f],r[i]&&d.push(r[i][0]),r[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(u&&u(t);d.length;)d.shift()();return a.push.apply(a,s||[]),o()}function o(){for(var e,t=0;t<a.length;t++){for(var o=a[t],n=!0,c=1;c<o.length;c++){var l=o[c];0!==r[l]&&(n=!1)}n&&(a.splice(t--,1),e=i(i.s=o[0]))}return e}var n={},r={0:0},a=[];function i(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=n,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var u=l;a.push([258,1]),o()}({104:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});o(13);window.WebRTC=window.WebRTC||window.NRTC,t.default={wbInfo:{colorList:["#efa700","#28cf30","#2d48a1","#df23df","#d63232","#000"],color:"#000",styleList:["line","rect","circle"],style:"free"},serializeFileStateMap:{UNKNOWN:"0",PRETRANS:"1",TRANSING:"2",TRANSTIMEOUT:"3",TRANSCOMPLETE:"4",TRANSFAIL:"5",UPLOADING:"11",UPLOADDONE:"12",UPLOADFAIL:"13"},unserializeFileStateMap:{0:"UNKNOWN",1:"PRETRANS",2:"TRANSING",3:"TRANSTIMEOUT",4:"TRANSCOMPLETE",5:"TRANSFAIL",11:"UPLOADING",12:"UPLOADDONE",13:"UPLOADFAIL"},unserializeFileStateText:{0:"状态未知",1:"转码准备中",2:"转码中",3:"转码超时",4:"转码成功",5:"转码失败",11:"上传中",12:"上传完成",13:"上传失败"},serializefileTypeMap:{1:"ppt",2:"pptx",3:"pdf"},unserializefileTypeMap:{ppt:1,pptx:2,pdf:3},fileTypeMap:{10:"jpg",11:"png",0:"unknown"}}},105:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Loading=t.Whiteboard=t.Netcall=t.Chatroom=void 0;var n=c(o(517)),r=c(o(522)),a=c(o(523)),i=c(o(532));function c(e){return e&&e.__esModule?e:{default:e}}t.Chatroom=n.default,t.Netcall=r.default,t.Whiteboard=a.default,t.Loading=i.default},106:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i(o(26)),i(o(25));var n=i(o(27)),r=(i(o(42)),i(o(106)),o(11)),a=o(13);function i(e){return e&&e.__esModule?e:{default:e}}r.StoreNim.state,r.StoreNim,r.StoreChatroom.state,r.StoreChatroom;var c=r.StoreNetcall.state,l=r.StoreNetcall,s=(r.StoreEventPool,r.StoreEventPool.state);t.default={handleRtcPermissionAndDraw:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;(console.log("******* handleRtcPermissionAndDraw(权限与绘制归一处理器) ********* "),console.log(e,t),s.remoteTrackNotifications[e])?a.Storage.get("teacherAccount")==e&&c.video4ScreenSharing&&c.screenShareing4Local?this.renderRemoteVideo4ScreenShareing(e):this.renderRemoteVideo(e,t):console.warn("### 等待首次远程轨道通知，尚未收到remoteTrack...",e)},renderRemoteVideo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=void 0==t?this.findRtcUserIndex(e):t;if(-1==o)for(var r=0;r<c.members.length;r++)if(0===c.members[r].account.length){o=r;break}console.log("*** 设置远程视频画面：",e,c.doms[o]),n.default.startRemoteStream(e,c.doms[o]),n.default.setVideoViewRemoteSize(e)},renderRemoteVideo4ScreenShareing:function(e){var t=document.getElementById("m-whiteboard-fullscreen");n.default.startRemoteStream(e,t),n.default.setVideoViewRemoteSize(e,700,490)},findRtcUserIndex:function(e){return l.findMember({account:e})}}},11:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StoreEventPool=t.StoreWhiteBoard=t.StoreNetcall=t.StoreChatroom=t.StoreNim=void 0;var n=l(o(510)),r=l(o(511)),a=l(o(512)),i=l(o(513)),c=l(o(514));function l(e){return e&&e.__esModule?e:{default:e}}var s=window.SNM=new n.default,u=window.SCR=new r.default,f=window.SNC=new a.default,d=window.SWB=new i.default,m=window.SEP=new c.default;t.StoreNim=s,t.StoreChatroom=u,t.StoreNetcall=f,t.StoreWhiteBoard=d,t.StoreEventPool=m},13:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(478);Object.defineProperty(t,"Ajax",{enumerable:!0,get:function(){return y(n).default}});var r=o(195);Object.defineProperty(t,"asynLoad",{enumerable:!0,get:function(){return y(r).default}});var a=o(479);Object.defineProperty(t,"Init",{enumerable:!0,get:function(){return y(a).default}});var i=o(481);Object.defineProperty(t,"Storage",{enumerable:!0,get:function(){return y(i).default}});var c=o(198);Object.defineProperty(t,"Alert",{enumerable:!0,get:function(){return y(c).default}});var l=o(218);Object.defineProperty(t,"Toast",{enumerable:!0,get:function(){return y(l).default}});var s=o(553);Object.defineProperty(t,"Loading",{enumerable:!0,get:function(){return y(s).default}});var u=o(220);Object.defineProperty(t,"Page",{enumerable:!0,get:function(){return y(u).default}});var f=o(197);Object.defineProperty(t,"Logger",{enumerable:!0,get:function(){return y(f).default}});var d=o(554);Object.defineProperty(t,"Pipes",{enumerable:!0,get:function(){return y(d).default}});var m=o(555);Object.defineProperty(t,"AppendToDom",{enumerable:!0,get:function(){return y(m).default}});var p=o(556);Object.defineProperty(t,"AsyncComponent",{enumerable:!0,get:function(){return y(p).default}});var h=o(557);Object.defineProperty(t,"CheckBroswer",{enumerable:!0,get:function(){return y(h).default}});var g=o(217);Object.defineProperty(t,"Valid",{enumerable:!0,get:function(){return y(g).default}});var b=o(558);Object.defineProperty(t,"MD5",{enumerable:!0,get:function(){return y(b).default}});var v=o(559);function y(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"Throttle",{enumerable:!0,get:function(){return y(v).default}})},144:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=o(19),l=d(o(7)),s=(o(23),d(o(26)),d(o(25)),d(o(27))),u=o(11),f=o(13);function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}console.log("!!!!!!!!!",f.Throttle);u.StoreNim.state,u.StoreNim,u.StoreChatroom.state,u.StoreChatroom;var p=u.StoreNetcall.state,h=u.StoreNetcall,g=(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={preventDom:null,timer:null,ChangeVideoStatus:!0,ChangeAudioStatus:!0},n.onMouseOver=function(e){n.state.timer&&(clearTimeout(n.state.timer),n.setState({timer:null}),n.state.preventDom&&(n.state.preventDom.style.display="none")),n.getTipDom(e).style.display="block"},n.onMouseOut=function(e){var t=n.getTipDom(e);n.setState({timer:setTimeout(function(){t.style.display="none"},250),preventDom:t})},m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"toggleVideo",value:function(){var e=this;if(1!=p.tabIndex){if(this.state.ChangeVideoStatus){this.setState({ChangeVideoStatus:!1});var t=!p.video;h.setVideo(t),console.log("toggleVideo -> ",t),t?s.default.startCamera().then(function(){console.log("==本地摄像头开启成功"),s.default.setVideoViewSize(),s.default.startLocalStream(e.dom),e.setState({ChangeVideoStatus:!0})}).catch(function(t){e.setState({ChangeVideoStatus:!0}),console.error("==本地摄像头开启失败",t)}):s.default.stopCamera().then(function(){console.log("==本地摄像头关闭成功"),s.default.stopLocalStream(e.dom),e.setState({ChangeVideoStatus:!0})}).catch(function(t){console.error("==本地摄像头关闭失败",t),e.setState({ChangeVideoStatus:!0})})}}else console.error("屏幕共享不关闭摄像头")}},{key:"toggleAudio",value:function(){var e=this;if(this.state.ChangeAudioStatus){this.setState({ChangeAudioStatus:!1});var t=!p.audio;h.setAudio(t),console.log("toggleAudio -> ",t),t?s.default.startMicro().then(function(){e.setState({ChangeAudioStatus:!0}),console.log("==本地麦克风关闭成功")}).catch(function(t){console.error("==本地麦克风关闭/播放本地音频失败",t),"NotAllowedError"==t&&h.setHasAudio(!1),e.setState({ChangeAudioStatus:!0})}):s.default.stopMicro().then(function(){e.setState({ChangeAudioStatus:!0}),console.log("==本地麦克风关闭成功")}).catch(function(t){console.error("==本地麦克风关闭/停止播放本地音频失败",t),"NotAllowedError"==t&&h.setHasVideo(!1),e.setState({ChangeAudioStatus:!0})})}}},{key:"toggleFullscreen",value:function(){var e=document.getElementById("m-whiteboard-fullscreen");if(e){h.setScreenShareing4Local(!0);var t=this.props.account;console.log("### 放大",t,e),s.default.startRemoteStream(t,e),s.default.setVideoViewRemoteSize(t,700,490),document.querySelectorAll("video").forEach(function(e){e.play()})}else console.error("节点未准备完毕")}},{key:"getTipDom",value:function(e){return"video"==e?document.getElementById("tip4video"):document.getElementById("tip4audio")}},{key:"render",value:function(){var e=this,t=this.props,o=t.className,n=t.account,r=void 0===n?"":n,a=t.self,c=void 0!==a&&a,s=t.offline,u=void 0!==s&&s,d=(t.index,r==f.Storage.get("teacherAccount"));return i.default.createElement("div",{className:(0,l.default)("m-netcall-video",o)},i.default.createElement("div",{className:"video-name"},r),i.default.createElement("div",{className:(0,l.default)("m-video",r&&""!=r?1==u?"room-offline":"room-hasuser":""),id:o,ref:function(t){return e.dom=t}}),!u&&d&&p.video4ScreenSharing&&!p.screenShareing4Local&&i.default.createElement("div",{className:"video-toolbar"},i.default.createElement("span",{className:(0,l.default)("fullscreen",p.screenShareing4Local?"":"fullscreen-open"),onClick:(0,f.Throttle)(this.toggleFullscreen.bind(this),250,1e3)})),!u&&c&&i.default.createElement("div",{className:"video-toolbar"},p.hasVideo?i.default.createElement("span",{className:(0,l.default)("video",p.video?"video-open":"video-close",p.shareStarted?"hide-import":""),onClick:(0,f.Throttle)(this.toggleVideo.bind(this),250,1e3)}):i.default.createElement("span",null,i.default.createElement("span",{id:"tip4video",className:"tip tip4video",style:{display:"none"}},"摄像头不可用"),i.default.createElement("span",{className:(0,l.default)("video","video-disabled",p.shareStarted?"hide-import":""),onMouseOver:this.onMouseOver.bind(this,"video"),onMouseOut:this.onMouseOut.bind(this,"video")})),p.hasAudio?i.default.createElement("span",{className:(0,l.default)("audio",p.audio?"audio-open":"audio-close"),onClick:(0,f.Throttle)(this.toggleAudio.bind(this),250,1e3)}):i.default.createElement("span",null,i.default.createElement("span",{id:"tip4audio",className:"tip tip4audio",style:{display:"none"}},"麦克风不可用"),i.default.createElement("span",{className:(0,l.default)("audio","audio-disabled"),onMouseOver:this.onMouseOver.bind(this,"audio"),onMouseOut:this.onMouseOut.bind(this,"audio")}))))}}]),t}())||n;t.default=g},145:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(561);Object.defineProperty(t,"Header",{enumerable:!0,get:function(){return function(e){return e&&e.__esModule?e:{default:e}}(n).default}})},195:function(e,t,o){"use strict";function n(e){var t=void 0;return(t=document.getElementById(e))?Promise.resolve():(console.log("asynLoad start url: ",e),/\.css$/.test(e)&&((t=document.createElement("link")).rel="stylesheet",t.href=e),/\.js$/.test(e)&&((t=document.createElement("script")).src=e),t.id=e,new Promise(function(e,o){t.onload=e,document.body.appendChild(t)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)return Promise.reject("");if(e.constructor===String)return n(e);if(e.constructor===Array){var t=[];return e.map(function(e){t.push(n(e))}),Promise.all(t)}return Promise.reject("unknown parameter type of asynLoad",e)}},197:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={info:"blue",log:"#3d6dad",warn:"orange",error:"red"},r={init:function(){this.loggerInfo=console.info,this.loggerWarn=console.warn,this.loggerError=console.error,this.loggerLog=console.log,this.reset()},reset:function(){var e=this;window.console.info=function(){e.logProxy(["info"].concat(Array.prototype.slice.call(arguments)))},window.console.log=function(){e.logProxy(["log"].concat(Array.prototype.slice.call(arguments)))},window.console.warn=function(){e.logProxy(["warn"].concat(Array.prototype.slice.call(arguments)))},window.console.error=function(){e.logProxy(["error"].concat(Array.prototype.slice.call(arguments)))}},logProxy:function(){var e=arguments[0];if(1!==e.length){var t=e[0],o="color:"+n[t]+";font-size:15px";e.shift(),e[0]="%c"+e[0],e.splice(1,0,o),this.loggerLog.apply(console,e)}},log:function(e){var t=console;return function(o,n,r){console.log(o,n,r);var a=r.value;r.value=function(){for(var r=arguments.length,i=Array(r),c=0;c<r;c++)i[c]=arguments[c];t.info("("+e+") before function execute: "+n+"("+i+") = ?");var l=a.apply(o,i);return t.info("("+e+")after function execute: "+n+"("+i+") => "+l),l}}}};console.log("logger",r),t.default={init:r.init.bind(r),log:r.log}},198:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(482);!function(e){e&&e.__esModule}(o(217));t.default={open:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.className,o=e.title,r=void 0===o?"提示":o,a=e.msg,i=e.btns,c=void 0===i?[]:i,l=e.close,s=e.isHtml,u={className:t,title:r,msg:a&&a.$$typeof?a:a.constructor===String?a:JSON.stringify(a),btns:c,close:l,isHtml:s};n.AlertCtrl.show(u)},close:function(){console.log("门面方法调用..."),n.AlertCtrl.hide()}}},199:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=u(r),i=u(o(7)),c=u(o(200)),l=o(23),s=o(13);function u(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={visible:!1},n.hide=function(){return n.setState({visible:!1}),n},n.btnClick=function(e){console.log("btn click=>",e),(0,e.onClick)(e)},f(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"show",value:function(e){var t=Object.assign(this.state,{visible:!0},e);return console.log("弹窗新属性: ",t),this.setState(t),this}},{key:"render",value:function(){var e=this,t=this.state,o=t.className,n=t.title,r=t.msg,s=t.btns,u=void 0===s?[]:s,f=t.close,d=t.isHtml;return a.default.createElement("div",{className:"u-alert-wrapper",hidden:!this.state.visible},a.default.createElement("div",{className:"u-mask"}),a.default.createElement("div",{className:(0,i.default)("u-alert",o)},a.default.createElement("div",{className:"alert-header"},a.default.createElement("div",{className:"title"},n||"提示"),a.default.createElement("div",{className:"close",onClick:function(){f?f():e.hide()}})),a.default.createElement("div",{className:"alert-body"},d?(0,c.default)(r):r),u&&u.length>0&&a.default.createElement("div",{className:"alert-footer"},u.map(function(t,o){return a.default.createElement(l.Button,{key:o,className:t.clsName,onClick:function(){return e.btnClick(t)}},t.label)}))))}}],[{key:"newInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.AppendToDom)(this,e,null)}}]),t}();t.default=d},206:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=i(r);i(o(7)),o(23);function i(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=(e.className,e.message),o=e.close,n=e.onClick;return a.default.createElement("div",{className:"u-tip"},a.default.createElement("div",{className:"u-tip-message"},t,o&&a.default.createElement("div",{className:"close",onClick:n})))}}]),t}();t.default=c},207:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(o(75)).default.emojiBaseUrl,r={emoji:{"[大笑]":{file:"emoji_0.png"},"[可爱]":{file:"emoji_01.png"},"[色]":{file:"emoji_02.png"},"[嘘]":{file:"emoji_03.png"},"[亲]":{file:"emoji_04.png"},"[呆]":{file:"emoji_05.png"},"[口水]":{file:"emoji_06.png"},"[汗]":{file:"emoji_145.png"},"[呲牙]":{file:"emoji_07.png"},"[鬼脸]":{file:"emoji_08.png"},"[害羞]":{file:"emoji_09.png"},"[偷笑]":{file:"emoji_10.png"},"[调皮]":{file:"emoji_11.png"},"[可怜]":{file:"emoji_12.png"},"[敲]":{file:"emoji_13.png"},"[惊讶]":{file:"emoji_14.png"},"[流感]":{file:"emoji_15.png"},"[委屈]":{file:"emoji_16.png"},"[流泪]":{file:"emoji_17.png"},"[嚎哭]":{file:"emoji_18.png"},"[惊恐]":{file:"emoji_19.png"},"[怒]":{file:"emoji_20.png"},"[酷]":{file:"emoji_21.png"},"[不说]":{file:"emoji_22.png"},"[鄙视]":{file:"emoji_23.png"},"[阿弥陀佛]":{file:"emoji_24.png"},"[奸笑]":{file:"emoji_25.png"},"[睡着]":{file:"emoji_26.png"},"[口罩]":{file:"emoji_27.png"},"[努力]":{file:"emoji_28.png"},"[抠鼻孔]":{file:"emoji_29.png"},"[疑问]":{file:"emoji_30.png"},"[怒骂]":{file:"emoji_31.png"},"[晕]":{file:"emoji_32.png"},"[呕吐]":{file:"emoji_33.png"},"[拜一拜]":{file:"emoji_160.png"},"[惊喜]":{file:"emoji_161.png"},"[流汗]":{file:"emoji_162.png"},"[卖萌]":{file:"emoji_163.png"},"[默契眨眼]":{file:"emoji_164.png"},"[烧香拜佛]":{file:"emoji_165.png"},"[晚安]":{file:"emoji_166.png"},"[强]":{file:"emoji_34.png"},"[弱]":{file:"emoji_35.png"},"[OK]":{file:"emoji_36.png"},"[拳头]":{file:"emoji_37.png"},"[胜利]":{file:"emoji_38.png"},"[鼓掌]":{file:"emoji_39.png"},"[握手]":{file:"emoji_200.png"},"[发怒]":{file:"emoji_40.png"},"[骷髅]":{file:"emoji_41.png"},"[便便]":{file:"emoji_42.png"},"[火]":{file:"emoji_43.png"},"[溜]":{file:"emoji_44.png"},"[爱心]":{file:"emoji_45.png"},"[心碎]":{file:"emoji_46.png"},"[钟情]":{file:"emoji_47.png"},"[唇]":{file:"emoji_48.png"},"[戒指]":{file:"emoji_49.png"},"[钻石]":{file:"emoji_50.png"},"[太阳]":{file:"emoji_51.png"},"[有时晴]":{file:"emoji_52.png"},"[多云]":{file:"emoji_53.png"},"[雷]":{file:"emoji_54.png"},"[雨]":{file:"emoji_55.png"},"[雪花]":{file:"emoji_56.png"},"[爱人]":{file:"emoji_57.png"},"[帽子]":{file:"emoji_58.png"},"[皇冠]":{file:"emoji_59.png"},"[篮球]":{file:"emoji_60.png"},"[足球]":{file:"emoji_61.png"},"[垒球]":{file:"emoji_62.png"},"[网球]":{file:"emoji_63.png"},"[台球]":{file:"emoji_64.png"},"[咖啡]":{file:"emoji_65.png"},"[啤酒]":{file:"emoji_66.png"},"[干杯]":{file:"emoji_67.png"},"[柠檬汁]":{file:"emoji_68.png"},"[餐具]":{file:"emoji_69.png"},"[汉堡]":{file:"emoji_70.png"},"[鸡腿]":{file:"emoji_71.png"},"[面条]":{file:"emoji_72.png"},"[冰淇淋]":{file:"emoji_73.png"},"[沙冰]":{file:"emoji_74.png"},"[生日蛋糕]":{file:"emoji_75.png"},"[蛋糕]":{file:"emoji_76.png"},"[糖果]":{file:"emoji_77.png"},"[葡萄]":{file:"emoji_78.png"},"[西瓜]":{file:"emoji_79.png"},"[光碟]":{file:"emoji_80.png"},"[手机]":{file:"emoji_81.png"},"[电话]":{file:"emoji_82.png"},"[电视]":{file:"emoji_83.png"},"[声音开启]":{file:"emoji_84.png"},"[声音关闭]":{file:"emoji_85.png"},"[铃铛]":{file:"emoji_86.png"},"[锁头]":{file:"emoji_87.png"},"[放大镜]":{file:"emoji_88.png"},"[灯泡]":{file:"emoji_89.png"},"[锤头]":{file:"emoji_90.png"},"[烟]":{file:"emoji_91.png"},"[炸弹]":{file:"emoji_92.png"},"[枪]":{file:"emoji_93.png"},"[刀]":{file:"emoji_94.png"},"[药]":{file:"emoji_95.png"},"[打针]":{file:"emoji_96.png"},"[钱袋]":{file:"emoji_97.png"},"[钞票]":{file:"emoji_98.png"},"[银行卡]":{file:"emoji_99.png"},"[手柄]":{file:"emoji_100.png"},"[麻将]":{file:"emoji_101.png"},"[调色板]":{file:"emoji_102.png"},"[电影]":{file:"emoji_103.png"},"[麦克风]":{file:"emoji_104.png"},"[耳机]":{file:"emoji_105.png"},"[音乐]":{file:"emoji_106.png"},"[吉他]":{file:"emoji_107.png"},"[火箭]":{file:"emoji_108.png"},"[飞机]":{file:"emoji_109.png"},"[火车]":{file:"emoji_110.png"},"[公交]":{file:"emoji_111.png"},"[轿车]":{file:"emoji_112.png"},"[出租车]":{file:"emoji_113.png"},"[警车]":{file:"emoji_114.png"},"[自行车]":{file:"emoji_115.png"}}};for(var a in r){var i=r[a];for(var c in i){var l=i[c];l.img=n+"/"+a+"/"+l.file}}for(var s={ajmd:{},xxy:{},lt:{}},u=1;u<=48;u++){var f="ajmd0"+(u>=10?u:"0"+u);s.ajmd[f]={file:f+".png"}}for(var d=1;d<=40;d++){var m="xxy0"+(d>=10?d:"0"+d);s.xxy[m]={file:m+".png"}}for(var p=1;p<=20;p++){var h="lt0"+(p>=10?p:"0"+p);s.lt[h]={file:h+".png"}}for(var g in s){var b=s[g];for(var v in b){var y=b[v];y.img=n+"/"+g+"/"+y.file}}t.default={emojiList:r,pinupList:s}},208:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={loginUrl:"#/login",registUrl:"#/regist",defaultUserIcon:"http://yx-web.nos.netease.com/webdoc/h5/im/default-icon.png"}},217:function(e,t,o){"use strict";function n(e){return e&&e.constructor}Object.defineProperty(t,"__esModule",{value:!0}),t.default={isString:function(e){return n(e)===String},isNumber:function(e){return n(e)===Number},isBoolean:function(e){return n(e)===Boolean},isArray:function(e){return n(e)===Array},isFunction:function(e){return n(e)===Function},isUndefined:function(e){return void 0===n(e)},isNull:function(e){return null===n(e)},isBlank:function(e){return""==e||0==e.trim().length},removeSpace:function(e){var t=this;if(!e)return"";switch(e.constructor){case String:return e.replace(/(^\s*)|(\s*$)/g,"");case Array:return e.map(function(e){return t.removeSpace(e)});case Object:return Object.keys(e).map(function(o){return e[o]=t.removeSpace(e[o])},e),e;default:return e}},param:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];if(!t)return!0;t=t.split(" ");try{t.map(function(t){if(!e[t])throw Error("no")})}catch(e){return!1}return!0},encode:function(e,t){return t=""+t,e&&t?t.replace(e.r,function(t){var o=e[e.i?t:t.toLowerCase()];return null!=o?o:t}):t||""},escape:function(e){return(e=this.encode({r:/\<|\>|\&|\r|\n|\s|\'|\"/g,"<":"&lt;",">":"&gt;","&":"&amp;"," ":"&nbsp;",'"':"&quot;","'":"&#39;","\n":"<br/>","\r":""},e)).replace(/<br\/?>$/,"<br/>")}}},218:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.msg,o=e.time,r=e.close,a={message:t.constructor===String?t:JSON.stringify(t),time:o,close:r};n.ToastCtrl.show(a)};var n=o(551)},219:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=o(1),c=u(i),l=(u(o(7)),o(23),u(o(206))),s=o(13);function u(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d={hidden:!0},m=(r=n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state=d,n.hide=function(){var e=n.state.visible;return console.log("toast hide",e,n.state),n.setState({visible:!1}),n},n.onClick=function(e){var t=e.onClick;n.hide(),s.Valid.isFunction(t)&&t(e)},f(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),a(t,[{key:"show",value:function(e){this.state.visible;var t=Object.assign(this.state,this.props,{hidden:!1,visible:!0},e);return this.setState(t),this}},{key:"render",value:function(){var e=this.state,t=(e.className,e.message,e.close);return this.state.onClick=this.onClick.bind(this,{onClick:t}),c.default.createElement("div",{hidden:!this.state.visible},c.default.createElement(l.default,this.state))}}],[{key:"newInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=Object.assign(e,{className:"u-toast"}),(0,s.AppendToDom)(this,e,null)}}]),t}(),n.defaultProps=d,r);t.default=m},220:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(o(218));t.default={page:"",message:"",pageDone:!1,to:function(e,t){if(console.log("page to",e,t),this.message=t,e===this.page)return this.done();this.page=e,location.href="#/"+e},back:function(e){console.log("page back",e),this.message=e,history.back()},done:function(){var e=this;this.page=location.hash.replace("#/",""),console.log("page done",this.message),this.message&&setTimeout(function(){(0,n.default)({time:5,msg:e.message}),e.message=""},500)}}},23:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectCom=t.EmojiPanel=t.Pagination=t.Mask=t.Icon=t.Progress=t.Tooltip=t.Tip=t.TextArea=t.Input=t.Col=t.Row=t.Button=void 0;var n=g(o(498)),r=g(o(499)),a=g(o(500)),i=g(o(501)),c=g(o(502)),l=g(o(503)),s=g(o(504)),u=g(o(505)),f=g(o(506)),d=g(o(507)),m=g(o(508)),p=g(o(509)),h=g(o(549));function g(e){return e&&e.__esModule?e:{default:e}}t.Button=n.default,t.Row=r.default,t.Col=a.default,t.Input=i.default,t.TextArea=c.default,t.Tip=l.default,t.Tooltip=s.default,t.Progress=u.default,t.Icon=f.default,t.Mask=d.default,t.Pagination=m.default,t.EmojiPanel=p.default,t.SelectCom=h.default},25:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(o(75)),r=(u(o(208)),o(13)),a=o(11),i=u(o(26)),c=(u(o(25)),u(o(27))),l=u(o(42)),s=(o(105),u(o(207)));function u(e){return e&&e.__esModule?e:{default:e}}var f=a.StoreChatroom.state,d=a.StoreChatroom,m=a.StoreNim.state,p=a.StoreNim,h=a.StoreNetcall.state,g=a.StoreNetcall;t.default={createChatroomMsg4Component:function(e,t,o,n,r,a){return{type:e,account:t,avatar:o,nick:n,content:r,catalog:a}},createMember4Component:function(e,t,o,n,r){return{type:e,account:t,avatar:o,nick:n,enterTime:r}},handleEmojiText:function(e){(console.log("source text: ",e),/\[[^\]]+\]/.test(e))&&e.match(/\[[^\]]+\]/g).forEach(function(t){var o=s.default.emojiList.emoji;o[t]&&(e=e.replace(t,'<img class="emoji" src="'+o[t].img+'?imageView&thumbnail=28x28">'))});return console.log("target text: ",e),e},formatChatroomMsg:function(e,t){var o=this;switch(e.type){case"text":var a=e.text;return console.log("sourceText: ",a),a=r.Valid.escape(a),console.log("escape: ",a),a=this.handleEmojiText(a),this.createChatroomMsg4Component("text",e.from,e.fromAvatar,e.fromNick,a);case"notification":var l=e.attach;switch(l.type){case"memberEnter":if(!t){this.getChatroomMembersInfo(e.from).then(function(e){console.log("memberEnter ->",e),d.addMember(o.createMember4Component(e.members[0].type,e.members[0].account,e.members[0].avatar,e.members[0].nick,e.members[0].enterTime))}).catch(function(e){console.error("获取成员信息失败...",e)});var s=r.Storage.get("isTeacher"),u=r.Storage.get("account"),b=r.Storage.get("teacherAccount");if(h.fromCreate)return g.setFromCreate(!1),console.log("设置[创建房间]的标记为false，老师首次创建房间不发起请求权限人员消息..."),this.createChatroomMsg4Component("notification",e.from,"","",l.from==m.account?"欢迎你进入房间":l.from+"进入了房间");if(e.from==b&&(console.log("===老师重新上线---\x3e"),1==s?g.addMember({account:e.from,self:!0},!0,!1):g.addMember({account:e.from,self:!1},!0,!1),c.default.reDrawVideos()),1==s&&e.from!=u){console.log("### 老师端有学生上线...");var v=[];h.members.forEach(function(e){e.account&&""!=e.account&&v.push(e.account)}),console.log("uids: ",v),i.default.sendCustomSysMsg(e.from,{room_id:f.currChatroomId,command:1,uids:v}).then(function(){console.log("**** 主持人点对点通知有权限的成员列表成功")}).catch(function(e){console.error("**** 主持人点对点通知有权限的成员列表失败",e)})}else e.from==u&&(console.log((e.from==b?"老师":"学生")+"上线，向所有人发送请求有权限的成员消息(2s后）进行"),setTimeout(function(){if(m.hasReceiveHostMsg)return p.setHasReceiveHostMsg(!1),void console.log("#### 已收到主持人的有权限成员列表通知消息，不进行收集权限过程");console.log("*** 开始权限收集"),o.sendCustomMsg({room_id:f.currChatroomId,command:2}).then(function(){console.log("请求有权限成员的聊天室消息成功")}).catch(function(e){console.error("请求有权限成员的聊天室消息失败",e)})},2e3))}return this.createChatroomMsg4Component("notification",e.from,"","",l.from==m.account?"欢迎你进入房间":l.from+"进入了房间");case"memberExit":return t||d.delMember(e.from),this.createChatroomMsg4Component("notification",e.from,"","",l.from+"离开了房间");case"updateChatroom":if(!t){console.log("#### updateChatroom: ",l.custom);var y=null;try{y=JSON.parse(l.custom)}catch(e){}if(null==y)return void console.error("解析custom失败");if(console.log("custom: ",y),g.setVideo4ScreenShareing(1==y.fullScreenType),0==y.fullScreenType){console.log(" 重新设置对应老师画面..."),g.setScreenShareing4Local(!1);var w=r.Storage.get("teacherAccount"),S=g.findMember({account:w});console.log("### 缩小",S,h.doms[S],w),c.default.startRemoteStream(w,h.doms[S]),c.default.setVideoViewRemoteSize(w)}else 0==r.Storage.get("isTeacher")&&g.setScreenShareing4Local(!1)}}break;case"custom":console.log("==== 聊天室自定义: ",e);var _=null;try{_=JSON.parse(e.content)}catch(e){console.error("解析聊天室自定义消息内容失败",e),_=null}if(!_)return void console.error("###聊天室自定义消息无内容");var C=_.type;if(1==C){var j=_.data.value,E=n.default.resourceUrl;return console.log(n.default),console.log("猜拳消息内容: ",j,E),this.createChatroomMsg4Component("caiquan",e.from,e.fromAvatar,e.fromNick,E+"/im/play-"+j+".png")}if(3==C){var O=_.data.catalog,P=_.data.chartlet,k=n.default.emojiBaseUrl+"/"+O+"/"+P+".png?imageView&thumbnail="+("emoji"==O?"28x28":"48x48");return this.createChatroomMsg4Component("emoji",e.from,e.fromAvatar,e.fromNick,k,O)}if(10==C){if(!t){var N=_.data.command;if(2==N)h.hasPermission&&i.default.sendCustomSysMsg(e.from,{room_id:f.currChatroomId,command:3,uids:[m.account]});else if(1==N){if(console.log("**** 主持人通知有权限成员列表的聊天室消息"),r.Storage.get("teacherAccount")!=e.from)return console.error("非主持人发送的权限广播消息，直接忽略 "),this.createChatroomMsg4Component("custom",e.from,"","","聊天室自定义消息忽略不显示");var M=_.data.uids,T=[],x="";f.members.forEach(function(e){e&&"owner"===e.type&&(x=e.account)}),M.forEach(function(e){e&&""!=e&&(x===e?T.unshift({account:e,self:e==m.account}):T.push({account:e,self:e==m.account}),0==r.Storage.get("isTeacher")&&d.setMemberStatus(e,1))}),f.members.forEach(function(e){var t=!1;M.forEach(function(o){e.account==o&&(t=!0)}),t||(console.log("已不再互动的成员状态重置:",e.account),d.setMemberStatus(e.account,0))});var R=[];h.members.forEach(function(e,t){-1==T.findIndex(function(t){return t.account==e.account})&&R.push({account:e.account,index:t})}),console.log("###### 已不再netcall互动列表的人员及对应位置为：",R),R.forEach(function(e){var t=h.doms[e.index];if(t){var o=t.getElementsByTagName("div");o.length>0&&(o=o[0],console.log("**** 清理不再互动的画面节点：",o),t.removeChild(o))}}),g.setMembers(T),c.default.reDrawVideos()}}}else console.log("忽略聊天室自定义消息type: ",C);return this.createChatroomMsg4Component("custom",e.from,"","","聊天室自定义消息忽略不显示")}return this.createChatroomMsg4Component("custom",e.from,"","","聊天室自定义消息忽略不显示")},onChatroomMsgs:function(e){var t=this;console.log("onChatroomMsgs",e),Array.isArray(e)||(e=[e]),e=e.map(function(e){return t.formatChatroomMsg(e,!1)}),console.log("$$$$$$$ 收到消息:",e.length,e),d.setMsgs(e),setTimeout(function(){var e=document.getElementById("chat-msg-list");e&&(e.scrollTop=e.scrollHeight)},0)},sendChatroomMsg:function(e){var t=f.currChatroom,o=this;return new Promise(function(n,r){t.sendText({text:e,done:function(e,t){e?r(e):(o.onChatroomMsgs([t]),n())}})})},sendCustomMsg:function(e){var t=f.currChatroom;return new Promise(function(o,n){t.sendCustomMsg({content:JSON.stringify({type:10,data:e}),done:function(e,t){e?n(e):o()}})})},sendCqMsg:function(){var e=f.currChatroom,t=this;return new Promise(function(o,n){e.sendCustomMsg({content:JSON.stringify({type:1,data:{value:Math.ceil(3*Math.random())}}),done:function(e,r){e?n(e):(t.onChatroomMsgs([r]),o())}})})},sendPinupMsg:function(e,t){var o=f.currChatroom,n=this;return new Promise(function(r,a){o.sendCustomMsg({content:JSON.stringify({type:3,data:{catalog:e,chartlet:t}}),pushContent:"[贴图表情]",done:function(e,t){e?a(e):(n.onChatroomMsgs([t]),r())}})})},create:function(e){var t={url:n.default.url+"/api/chatroom/create",type:"POST",data:{creator:a.StoreNim.state.account,name:e}};return(0,r.Ajax)(t).then(function(e){if(200===e.res){var t=e.msg;return Promise.resolve(t)}return Promise.reject("创建聊天室失败")}).catch(function(e){return console.error("创建聊天室请求错误或超时"),Promise.reject(e)})},login:function(e){var t=this,o={url:n.default.url+"/api/chatroom/getAddress",type:"POST",dataType:"form",data:{uid:a.StoreNim.state.account,roomid:e}};return(0,r.Ajax)(o).then(function(o){if(console.log("获取聊天室地址",o),200===o.res){var n=o.msg.addr;return t._login({chatroomId:e,address:n})}return Promise.reject(o.errmsg)}).catch(function(e){return console.error("获取roomid对应的聊天室地址请求错误或超时",e),Promise.reject(e)})},_login:function(e){var t=this,o=this,i=e.chatroomId,c=e.address;return i&&c?new Promise(function(e,l){window.chatroom=window.Chatroom.getInstance({appKey:n.default.appkey,account:a.StoreNim.state.account,token:a.StoreNim.state.token,chatroomId:i,chatroomAddresses:c,onconnect:function(t){console.log("聊天室连接已建立...",t),d.setChatroom(i,window.chatroom),d.setCurrChatroomId(i),o.getFirstMemebers(),o.doGetChatroom(),e()},onerror:function(e,t){e&&(conosole.error("chatroom::onerror",e),o.logout(f.currChatroomId,"网络连接状态异常")),l(e)},onwillreconnect:function(e){console.warn("chatroom::onwillreconnect",e),(0,r.Toast)({msg:"聊天室断开，正在重连中"})},ondisconnect:function(e){if(console.log("chatroom::ondisconnect",e),e)switch(e.code){case 302:r.Page.to("login","账号或者密码错误");break;case 13003:o.logout(f.currChatroomId,"抱歉，你已被踢出该房间并被拉入了黑名单");break;case"kicked":if("managerKick"===e.reason)o.logout(f.currChatroomId,"抱歉，你已被踢出该房间");else if("samePlatformKick"===e.reason)o.logout(f.currChatroomId,"不允许同一个帐号重复登录同一个聊天室");else if("chatroomClosed"===e.reason){if(o.clickBtnClose)return void(o.clickBtnClose=!1);var t="owner"!=f.type?"老师已经结束了教学":"抱歉，您被踢出(该账号在其他设备创建房间)";r.Alert.open({title:"提示",msg:'<div class="u-kickedroom"><i class="u-icon-tip"></i>'+t+"</div>",isHtml:!0,btns:[{label:"确认",clsName:"u-btn-smaller",onClick:function(){console.log("【提示退出房间】 --\x3e 确认"),o.doLogout()}}],close:function(){console.log("【提示退出房间】 --\x3e X"),o.doLogout()}})}else o.logout(f.currChatroomId,"被踢原因："+e.reason);break;default:(0,r.Toast)({msg:e.message})}},onmsgs:t.onChatroomMsgs.bind(t)})}):Promise.reject("请输入聊天室id和地址")},doGetChatroom:function(){this.getChatroom().then(function(e){console.log("获取聊天室信息成功:",e);var t=null;try{t=JSON.parse(e.chatroom.custom)}catch(e){}null!=t?(g.setVideo4ScreenShareing(1==t.fullScreenType),d.setCustom(t)):console.error("解析custom失败")}).catch(function(e){console.error("获取聊天室信息失败:",e)})},doLogout:function(){r.Alert.close(),this.logout(f.currChatroomId,"聊天室关闭了")},close:function(e){this.clickBtnClose=!0;var t={url:n.default.url+"/api/chatroom/close",type:"POST",data:{uid:a.StoreNim.state.account,roomid:e}};return(0,r.Ajax)(t).then(function(e){if(200===e.res){var t=e.msg;return Promise.resolve(t)}return Promise.reject("关闭聊天室失败")}).catch(function(e){return console.error("关闭聊天室请求错误或超时"),Promise.reject(e)})},logout:function(e,t){var o=f.currChatroom;o&&o.disconnect(),d.setChatroom(e,null),d.setCurrChatroomId(""),d.clearMsgs(),d.clearMembers(),d.setType(""),d.setIsShowMemberTab(!1),d.setLastTimestamp(0),d.setCanLoadHistory(!0),d.setShowEmojiPanel(!1),d.setHasPermissionRequest(!1),c.default.leaveChannel().then(function(){console.log("RTC房间离开成功"),c.default.clear(),l.default.leaveChannel(),l.default.clearAll()}).catch(function(e){console.error("RTC房间离开失败",e),c.default.clear()}),r.Storage.remove("roomId"),r.Storage.remove("isTeacher"),r.Storage.remove("joinFlag"),r.Page.to("home",t)},getChatroomMembers:function(e){var t=f.currChatroom;if(t)return new Promise(function(o,n){t.getChatroomMembers({guest:e,limit:100,done:function(e,t){e?n(e):o(t.members)}})})},getChatroomMembersInfo:function(e){var t=f.currChatroom;if(t)return new Promise(function(o,n){t.getChatroomMembersInfo({accounts:[e],done:function(e,t){e?n(e):(console.log(t),o(t))}})})},getHistoryMsgs:function(e){var t=f.currChatroom;if(t)return new Promise(function(o,n){t.getHistoryMsgs({timetag:e,limit:50,reverse:!1,done:function(e,t){e?n(e):(console.log("历史消息: ",t.msgs),o(t.msgs))}})})},getChatroom:function(){var e=f.currChatroom;if(e)return new Promise(function(t,o){e.getChatroom({done:function(e,n){e?o(e):t(n)}})})},getFirstMemebers:function(){var e=this;return this.getChatroomMembers(!1).then(function(t){console.log("获取聊天室成员(非游客)成功",t);var o=[];return t.forEach(function(t){t.online&&o.push(e.createMember4Component(t.type,t.account,t.avatar,t.nick,t.enterTime)),"owner"==t.type&&(console.log("预占位老师到RTC房间"),r.Storage.set("teacherAccount",t.account),t.account==m.account&&(console.log("=== 老师标记位重新设置：1"),r.Storage.set("isTeacher",1),g.settabindex(0),g.setShareStarted(!1),f.custom&&(f.custom.fullScreenType=0,i.default.updateChatroom(f.custom))),g.addMember({account:t.account,self:t.account==m.account,offline:!t.online}),t.account==m.account&&(console.log("=== 老师标记位重新设置：1"),r.Storage.set("isTeacher",1)))}),console.log(o),d.setMembers(o),console.log("现在的成员列表是： ",d.state.members),e.getChatroomMembers(!0)}).then(function(t){console.log("获取聊天室成员(游客)成功",t);var o=[];t.forEach(function(t){o.push(e.createMember4Component(t.type,t.account,t.avatar,t.nick,t.enterTime))}),console.log(o),d.setMembers(o),console.log("现在的成员列表是： ",d.state.members)}).catch(function(e){console.error("获取聊天室成员失败",e)})}}},258:function(e,t,o){"use strict";o(259),o(461),o(463),o(465);var n=l(o(1)),r=l(o(70)),a=o(647),i=o(646),c=l(o(477));function l(e){return e&&e.__esModule?e:{default:e}}r.default.render(n.default.createElement(i.HashRouter,null,(0,a.renderRoutes)(c.default)),document.getElementById("app"))},26:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(o(1)),r=d(o(75)),a=(d(o(208)),o(13)),i=o(515),c=o(11),l=d(o(25)),s=d(o(27)),u=d(o(42)),f=d(o(106));function d(e){return e&&e.__esModule?e:{default:e}}var m=c.StoreChatroom.state,p=c.StoreChatroom,h=c.StoreNim.state,g=c.StoreNim,b=c.StoreNetcall.state,v=c.StoreNetcall;c.StoreEventPool,c.StoreEventPool.state;window.WebRTC&&window.NIM.use(window.WebRTC),window.WhiteBoard&&window.NIM.use(window.WhiteBoard),t.default={regist:function(e){return a.Valid.param(e,"username password nickname")?(e.password=(0,a.MD5)(e.password),(0,a.Ajax)({url:r.default.url+"/api/createDemoUser",type:"POST",dataType:"form",data:e}).then(function(e){return e&&200===e.res?Promise.resolve():Promise.reject(e.errmsg)}).catch(function(e){return Promise.reject(e)})):Promise.reject("注册失败: 参数不完整，请检查")},login:function(e,t){var o=this;return h.nim?(console.log("=== 已存在的nim实例， 不再重新初始化..."),Promise.resolve()):e&&t?new Promise(function(n,i){window.nim=window.NIM.getInstance({debug:!0,appKey:r.default.appkey,account:e,token:t,db:!1,syncSessionUnread:!0,syncRobots:!0,autoMarkRead:!0,onconnect:function(o){console.log("im连接成功...."),g.setNim(window.nim),g.setAccount(e),g.setToken(t)},onerror:function(e){console.error("网络连接状态异常",e),a.Page.to("login","网络连接状态异常")},onwillreconnect:function(){console.log(event)},ondisconnect:function(e){var t="";switch(e.code){case 302:i("帐号或密码错误");break;case"kicked":var o=e.from;t="你的帐号于"+util.formatDate(new Date)+"被"+({PC:"电脑版",Web:"网页版",Android:"手机版",iOS:"手机版",WindowsPhone:"手机版"}[o]||"其他端")+"踢出下线，请确定帐号信息安全!",a.Page.to("login",t)}},onmsg:o.onMsg.bind(o),oncustomsysmsg:o.onCustomSysMsg.bind(o),onsyncdone:function(){console.log("onsyncdone"),n()}})}):Promise.reject("请输入登录名和密码")},onCustomSysMsg:function(e){var t=this;if(console.log("收到onCustomSysMsg: ",e),"custom"==e.type&&"p2p"==e.scene){var o=null;try{o=JSON.parse(e.content)}catch(e){console.error(e,"解析自定义系统通知消息内容失败"),o=null}if(!o)return void console.error("无内容：",o);if(console.log(o),10==o.type)switch(o.data.command){case 1:g.setHasReceiveHostMsg(!0),a.Storage.set("teacherAccount",e.from);var r=[];o.data.uids.forEach(function(t){r.push({account:t,self:h.account==t}),t!=e.from&&p.setMemberStatus(t,1)}),v.setMembers(r),r.forEach(function(e){f.default.handleRtcPermissionAndDraw(e.account)}),s.default.reDrawVideos();break;case 3:var c=e.from;v.addMember({account:c,self:!1}),p.setMemberStatus(c,1),f.default.handleRtcPermissionAndDraw(c);break;case 10:console.log("收到连麦请求",e),p.setMemberStatus(e.from,2),m.isShowMemberTab||(console.log("*** 当前不在成员列表TAB，设置有人请求加麦标记"),p.setHasPermissionRequest(!0));break;case 11:console.log("主持人同意连麦请求"),console.log("默认设置视频与麦克风都可用..."),v.setVideo(!0),v.setAudio(!0),a.Alert.open({title:"操作确认",msg:n.default.createElement(i.ConfirmDeviceContent,null),btns:[{label:"确定",clsName:"u-btn-smaller",onClick:function(){console.log("【设备确认弹窗】--\x3e 确定.."),t.doConfirmDevice()}}],close:function(){console.log("【设备确认弹窗】--\x3e X.."),t.doConfirmDevice()}});break;case 12:console.log("主持人拒绝连麦请求"),this.doEndInteraction4CurrentStudent(),a.Alert.open({title:"提示",msg:'<div class="u-end-interaction"><i class="u-icon-tip"></i>你被老师取消互动</div>',isHtml:!0,btns:[{label:"确定",clsName:"u-btn-smaller",onClick:function(){console.log("【老师剔除学生，学生提示弹窗】--\x3e 确定"),a.Alert.close()}}],close:function(){console.log("【老师剔除学生，学生提示弹窗】--\x3e x"),a.Alert.close()}});break;case 13:console.log("收到取消连麦请求",e),p.setMemberStatus(e.from,0),p.hasPermissionRequestMember()?console.log("尚有成员请求连麦，红点依然显示..."):(console.log("无成员请求连麦，红点直接不显示..."),p.setHasPermissionRequest(!1)),v.delMember(e.from),s.default.stopRemoteStream(e.from),s.default.stopPlayRemoteAudio(e.from),s.default.reDrawVideos();var u=[];b.members.forEach(function(e){e.account&&""!=e.account&&u.push(e.account)}),console.log("**** 成员取消或停止连麦， 主持人收到点对点后， 发送群广播。待通知有权限列表为：",u),l.default.sendCustomMsg({room_id:m.currChatroomId,command:1,uids:u}).then(function(){console.log("[停止互动后]主持人通知成员有权限的成员列表成功")}).catch(function(e){console.error("[停止互动后]主持人通知成员有权限的成员列表失败",e)})}}},sendCustomMsg:function(e,t){var o=h.nim;return new Promise(function(n,r){o.sendCustomMsg({scene:"p2p",to:e,content:JSON.stringify({type:10,data:t}),done:function(e,t){e?r(e):n()}})})},sendCustomSysMsg:function(e,t){var o=h.nim;return new Promise(function(n,r){o.sendCustomSysMsg({scene:"p2p",to:e,sendToOnlineUsersOnly:!0,isPushable:!1,content:JSON.stringify({type:10,data:t}),done:function(e,t){console.log("发送的自定义系统通知消息为：",t),e?r(e):n()}})})},updateChatroom:function(e){var t=m.currChatroom;if(t)return new Promise(function(o,n){t.updateChatroom({chatroom:{custom:JSON.stringify(e)},needNotify:!0,custom:JSON.stringify(e),done:function(e,t){console.log("更新聊天室信息"+(e?"失败":"成功"),e,t),e?n(e):o()}})})},onMsg:function(e){console.log("收到im消息onMsg: ",e)},doConfirmDevice:function(){a.Alert.close(),console.log("互动模式","audio: ",b.audio,", video: ",b.video),v.setHasPermission(!0),v.addMember({account:h.account,self:!0}),p.setMemberStatus(h.account,1),u.default.changeRoleToPlayer(),u.default.checkColor(),b.hasAudio&&b.audio&&s.default.startMicro().then(function(){console.log("===麦克风启动成功")}).catch(function(e){console.error("===麦克风启动失败",e),"NotAllowedError"==e&&v.setHasAudio(!1)}),b.hasVideo&&b.video&&s.default.startCamera().then(function(){console.log("===摄像头启动成功");var e=b.members.findIndex(function(e){return e.account==h.account});if(-1!=e){var t=b.doms[e];t?(console.log("当前人员加入节点：",t),s.default.startLocalStream(t),s.default.setVideoViewSize()):console.error("@@@@ 不存在的节点，忽略渲染本地流")}else console.error("不存在的成员, 无法渲染",h.account)}).catch(function(e){console.error("===摄像头启动失败",e),"NotAllowedError"==e&&v.setHasVideo(!1)}),s.default.changeRoleToPlayer()},doEndInteraction4CurrentStudent:function(){u.default.changeRoleToAudience();var e=b.members.findIndex(function(e){return e.account==h.account});-1==e?console.error("未找到对应DOM节点,无法停止流..."):s.default.stopLocalStream(b.doms[e]),v.delMember(h.account),v.setHasPermission(!1),v.setShowStatus(0),p.setMemberStatus(h.account,0),s.default.changeRoleToAudience().then(function(){return console.log("==== 切换为观众成功"),s.default.stopMicro()}).then(function(){return console.log("==== 停止麦克风成功"),v.setAudio(!1),s.default.stopCamera()}).then(function(){console.log("==== 停止摄像头成功"),v.setVideo(!1)}).catch(function(e){console.error("停止本地行为失败",e)})},logout:function(){h.nim&&h.nim.disconnect(),g.setAccount(""),g.setToken(""),window.nim=null,g.setNim(null),a.Storage.remove("account"),a.Storage.remove("token"),a.Page.to("login")}}},27:function(e,t,o){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});l(o(75));var r=o(11),a=(o(105),o(13)),i=(l(o(26)),l(o(25)),l(o(27))),c=l(o(106));l(o(107));function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var u=r.StoreNim.state,f=(r.StoreNim,r.StoreChatroom.state,r.StoreChatroom),d=r.StoreNetcall.state,m=r.StoreNetcall,p=r.StoreEventPool;r.StoreEventPool.state;t.default=(s(n={initSDK:function(){console.log("无WEBRTC实例，进行初始化..."),NIM.use(WebRTC),window.webrtcIns=window.WebRTC.getInstance({debug:!0,nim:u.nim,chromeId:"gapafbpmfemleaplicdhhcikajbogpkf"}),m.setWebRtc(window.webrtcIns),this.switchEventListener(!0)},switchEventListener:function(e){var t=d.webrtc,o=e?"on":"removeListener";t[o]("joinChannel",this.onJoinChannel.bind(this)),t[o]("leaveChannel",this.onLeaveChannel.bind(this)),t[o]("deviceStatus",this.onDeviceStatus.bind(this)),t[o]("deviceAdd",this.onDeviceAdd.bind(this)),t[o]("deviceRemove",this.onDeviceRemove.bind(this)),t[o]("audioVolume",this.onAudioVolume.bind(this)),t[o]("remoteSignalClosed",this.onRemoteSignalClosed.bind(this)),t[o]("signalClosed",this.onSignalClosed.bind(this)),t[o]("remoteTrack",this.onRemoteTrack.bind(this)),t[o]("control",this.onControlTrack.bind(this))},onJoinChannel:function(e){console.log("==== webrtc房间有人加入了",e)},onLeaveChannel:function(e){console.log("==== webrtc房间有人离开了",e),a.Storage.get("teacherAccount")!=e.account?(console.log("学生下线，清理房间占位"),m.delMember(e.account)):(console.log("老师下线，不清理房间占位"),m.setTeacherStatus(e.account,!0)),i.default.reDrawVideos(),e.account==u.account&&a.Storage.set("hasPermission",!1)},onDeviceStatus:function(e){console.log("==== webrtc 设备变更: ",e)},onDeviceAdd:function(e){var t=this;console.log("==== webrtc设备新增",e),e.forEach(function(e){"video"==e.type?(m.setHasVideo(!0),0==d.tabIndex&&t.doStartCamera()):"audioIn"==e.type&&t.doStartMicro()})},onDeviceRemove:function(e){var t=this;console.log("==== webrtc设备移除",e),e.forEach(function(e){"video"==e.type?d.webrtc.getDevicesOfType(WebRTC.DEVICE_TYPE_VIDEO).then(function(e){e.length>0?t.doStartCamera():(m.setHasVideo(!1),i.default.stopLocalStream())}):"audioIn"==e.type&&d.webrtc.getDevicesOfType(WebRTC.DEVICE_TYPE_AUDIO_IN).then(function(e){e.length>0?t.doStartMicro():m.setHasAudio(!1)})})},onAudioVolume:function(e){Object.keys(e).forEach(function(t){"self"==t?f.setMemberAudioVolume(u.account,e[t].status):f.setMemberAudioVolume(t,e[t].status)})},onRemoteSignalClosed:function(e){console.log("==== remoteSignalClosed ",e)},onSignalClosed:function(e){console.log("==== signalClosed ",e);var t=a.Storage.get("teacherAccount");u.account==t?m.setTeacherStatus(t,!0):(m.delMember(u.account),m.setHasPermission(!1)),f.delMember(u.account)},onRemoteTrack:function(e){console.log("==== 收到远程轨道",e);var t=e.account;console.log("remote account：",t),"video"==e.track.kind?(p.addRemoteTrackNotification(t),c.default.handleRtcPermissionAndDraw(t)):"audio"==e.track.kind&&i.default.startPlayRemoteAudio()},onControlTrack:function(e){console.log("触发控制",e)},doStartCamera:function(){if(m.setHasVideo(!0),d.video){console.log("当前需要开启摄像头...");var e=d.members.findIndex(function(e){return e.account==u.account});if(-1==e)return void console.error("未找到当前RTC房间互动者:",u.account);var t=d.doms[e];if(!t)return void console.error("@@@@ 不存在的节点，忽略渲染本地流");console.log("当前人员加入节点：",t),i.default.startCamera().then(function(){console.log("其他【摄像头】设备自动开启成功："),i.default.startLocalStream(t),i.default.setVideoViewSize()}).catch(function(e){console.error("其他【摄像头】设备自动开启失败：",e),"NotAllowedError"==e&&m.setHasVideo(!1)})}else console.log("当前不需要开启摄像头...")},doStartMicro:function(){if(m.setHasAudio(!0),d.audio){if(console.log("当前需要开启麦克风..."),-1==d.members.findIndex(function(e){return e.account==u.account}))return void console.error("未找到当前RTC房间互动者:",u.account);i.default.startMicro().then(function(){console.log("其他【麦克风】设备自动开启成功：")}).catch(function(e){console.error("其他【麦克风】设备自动开启失败：",e),"NotAllowedError"==e&&m.setHasAudio(!1)})}else console.log("当前不需要开启麦克风...")},createChannel:function(e){return console.log("createChannel -> ",e),d.webrtc.createChannel({channelName:e,webrtcEnable:!0})},joinChannel:function(e){console.log("joinChannel -> ",e);var t={videoQuality:WebRTC.CHAT_VIDEO_QUALITY_HIGH,videoFrameRate:WebRTC.CHAT_VIDEO_FRAME_RATE_25,highAudio:!1};return d.webrtc.joinChannel({channelName:e,type:WebRTC.NETCALL_TYPE_VIDEO,sessionConfig:t})},leaveChannel:function(){return console.log("leaveChannel"),d.webrtc.leaveChannel()},clear:function(){this.switchEventListener(!1),window.WebRTC.destroy(),window.webrtcIns=null,m.setWebRtc(null),m.setVideo4ScreenShareing(!1),m.setScreenShareing4Local(!1),m.clearDoms(),m.setFromCreate(!1),m.setHasPermission(!1),m.setShowStatus(0),m.clearMembers(),m.setVideo(!0),m.setAudio(!0),p.clearRemoteTrackNotifications(),WebRTC.checkCompatibility().then(function(e){var t=e.Camera,o=e.Microphone;console.log(e),m.setHasAudio(o),m.setHasVideo(t)}).catch(function(e){console.error("获取当前机器可用设备时异常: ",e),m.setHasAudio(!1),m.setHasVideo(!1)}),a.Storage.remove("hasPermission"),a.Storage.remove("teacherAccount")},reDrawVideos:function(){d.members.forEach(function(e,t){var o=e.account;""!=o?o==u.account?(console.log("重新渲染自己本地画面",o),i.default.startLocalStream(d.doms[t]),i.default.setVideoViewSize()):(console.log("重新渲染远程画面",o),c.default.handleRtcPermissionAndDraw(o,t)):console.log("ignore Unknown account",t)})},startMicro:function(){return d.webrtc.startDevice({type:WebRTC.DEVICE_TYPE_AUDIO_IN})},startCamera:function(){return d.webrtc.startDevice({type:WebRTC.DEVICE_TYPE_VIDEO})},startChromeShareScreen:function(){return d.webrtc.startDevice({type:WebRTC.DEVICE_TYPE_DESKTOP_CHROME_SCREEN})},stopMicro:function(){return d.webrtc.stopDevice(WebRTC.DEVICE_TYPE_AUDIO_IN)},stopCamera:function(){return d.webrtc.stopDevice(WebRTC.DEVICE_TYPE_VIDEO)},startLocalStream:function(e){d.webrtc.startLocalStream(e)},stopLocalStream:function(e){d.webrtc.stopLocalStream(e)}},"stopLocalStream",function(){d.webrtc.stopLocalStream()}),s(n,"changeRoleToPlayer",function(){return d.webrtc.changeRoleToPlayer()}),s(n,"changeRoleToAudience",function(){return d.webrtc.changeRoleToAudience()}),s(n,"startRtc",function(){return d.webrtc.startRtc()}),s(n,"startRemoteStream",function(e,t){d.webrtc.startRemoteStream({account:e,node:t})}),s(n,"stopRemoteStream",function(e){d.webrtc.stopRemoteStream(e)}),s(n,"startPlayLocalAudio",function(){return d.webrtc.startDevice({type:WebRTC.DEVICE_TYPE_AUDIO_OUT_LOCAL})}),s(n,"stopPlayLocalAudio",function(){return d.webrtc.stopDevice(WebRTC.DEVICE_TYPE_AUDIO_OUT_LOCAL)}),s(n,"startPlayRemoteAudio",function(e){d.webrtc.setAudioStart(e)}),s(n,"stopPlayRemoteAudio",function(e){d.webrtc.setAudioBlack(e)}),s(n,"setVideoViewSize",function(){setTimeout(function(){d.webrtc.setVideoViewSize({width:139,height:104,cut:!0})},200)}),s(n,"setVideoViewRemoteSize",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:139,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:104;d.webrtc.setVideoViewRemoteSize({account:e,width:t,height:o,cut:!0})}),n)},42:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(13),r=o(11),a=r.StoreWhiteBoard.state,i=r.StoreChatroom.state;t.default={wb:null,info:null,calling:!1,initSDK:function(){this.wb||(window.whiteboard=this.wb=WhiteBoard.getInstance({nim:window.nim,debug:!1}),this.bindEvent(),window.nim.on("notifyTransLog",function(e){console.log("notifyTransLog",e),r.StoreWhiteBoard.setFileState(e)}),this.initDrawPlugin())},initDrawPlugin:function(){var e=this;this.drawPlugin=new DrawPlugin(a.node,{UID:this.wb.getAccount(),nim:window.nim}),this.drawPlugin.on("data",function(t){var o=t.toAccount,n=void 0===o?0:o,r=t.data;r&&e.wb.sendData({toAccount:n,data:r})})},bindEvent:function(){var e=this.wb,t=this;e.on("signalClosed",function(e){t.hangup&&t.hangup(),console.error("on signalClosed",e)}),e.on("error",function(e){t.hangup&&t.hangup(),console.error("on error",e)}),e.on("joinChannel",function(e){console.log("onJoinChannel",e),e.account===n.Storage.get("teacherAccount")&&t.lazySync()}),e.on("data",function(e){console.log("data",e),t.drawPlugin&&t.drawPlugin.act({account:e.account,data:e.data})}),e.on("leaveChannel",function(e){console.log("onLeaveChannel",e)}),e.on("control",function(t){e.notCurrentChannelId(t)||console.log("onControl",t)})},createChannel:function(e){return console.log("wb::createChannel",e),this.wb.createChannel({channelName:e}).then(function(e){console.log("wb::createChannel success",e)}).catch(function(e){return console.error("wb::createChannelErr",e),Promise.reject(e)})},_startSession:function(){return this.wb.startSession()},clearAll:function(){this.wb.destroy(),this.wb=null,window.whiteboard=null,r.StoreWhiteBoard.whiteboard=null,this.drawPlugin.destroy(),this.drawPlugin=null},joinChannel:function(e){var t=this;return this.wb?(console.log("wb::joinChannel",e),this.info={channelName:e,sessionConfig:{color:"#000"}},(0,n.Pipes)(this._joinChannel.bind(this),this._startSession.bind(this)).then(function(e){console.log("wb::session Started",e)}).catch(function(e){return console.error("wb::joinChannelErr",e),t.wb.leaveChannel(),Promise.reject(e)})):Promise.reject("wb::没有实例化")},_joinChannel:function(){var e=this;return this.wb.joinChannel(this.info).then(function(){return e.lazySyncOwner(),Promise.resolve()})},leaveChannel:function(){console.log("wb::leaveChannel"),this.wb&&this.wb.leaveChannel(),r.StoreWhiteBoard.reset()},lazySync:function(){var e=this;setTimeout(function(){if(console.log("joinChannel SYNC",i.type),!i.type)return e.lazySync();if("owner"!==i.type){var t=n.Storage.get("teacherAccount");console.log("makeSync",t),e.syncRequest(t)}},50)},lazySyncOwner:function(){var e=this;setTimeout(function(){if(console.log("joinChannel SYNC",i.type),!i.type)return e.lazySyncOwner();"owner"===i.type&&(e.getFileList(),e.syncBegin())},50)},setContainer:function(e){console.log("wb::setContainer",e),r.StoreWhiteBoard.setContainer(e),this.drawPlugin&&this.drawPlugin.setContainer(e)},setColor:function(e){this.drawPlugin&&this.drawPlugin.setColor(e),r.StoreWhiteBoard.setColor(e)},checkColor:function(){this.setColor(a.currentDrawColor)},changeRoleToAudience:function(){console.log("wb::changeRoleToAudience"),this.drawPlugin&&this.drawPlugin.changeRoleToAudience()},changeRoleToPlayer:function(){console.log("wb::changeRoleToPlayer"),this.drawPlugin&&this.drawPlugin.changeRoleToPlayer()},setDrawModeFlag:function(){this.drawPlugin&&this.drawPlugin.setDrawMode("flag"),r.StoreWhiteBoard.setDrawMode("flag")},setDrawModeFree:function(){this.drawPlugin&&this.drawPlugin.setDrawMode("free"),r.StoreWhiteBoard.setDrawMode("free")},undo:function(){this.drawPlugin&&this.drawPlugin.undo()},redo:function(){this.drawPlugin&&this.drawPlugin.redo()},clear:function(){this.drawPlugin&&this.drawPlugin.clear()},uploadFile:function(){var e=a.fileInput;if(e){var t=null;console.log("uploadFile111");var o={transcode:"jpg",type:"file",beginupload:function(e){var o=e.options,n=o.fileInputName,a=o.transtype,i=o.docId;t=i,console.log("beginupload",e.options),console.log("fileInputName type",n,a),r.StoreWhiteBoard.addFile({docId:i,name:n,mime:a,state:11,percent:0,prefix:""})},uploadprogress:function(e){console.log("uploadprogress",e);var t={docId:e.docId,percent:e.percentage};100===t.percent&&(t.state=a.serializeFileStateMap.TRANSING,t.percent=0),r.StoreWhiteBoard.setFileState(t)},uploaddone:function(e,o){console.log("uploaddone",e,o,t);var n={docId:t,name:o.fileInputName,percent:100,state:2};e?n.state=a.serializeFileStateMap.UPLOADFAIL:(n.state=a.serializeFileStateMap.TRANSING,n.percent=0),r.StoreWhiteBoard.setFileState(n)},done:function(e,t){console.log("send file done",e,t)}};e&&(o.fileInput=e),window.nim.previewFile(o)}},setImage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.currentFile;console.log("setImage",t);t.name.replace(/\.\w+$/,"");var o=t.prefix+"_"+t.type+"_"+e+"."+a.fileTypeMap[t.transType];this.drawPlugin&&this.drawPlugin.image({url:o,docId:t.docId,pageCount:t.pageCount,currentPage:e}),r.StoreWhiteBoard.setCurrentFilePage(e)},clearFile:function(){this.drawPlugin&&this.drawPlugin.clearImage(),r.StoreWhiteBoard.setCurrentFile(-1)},deleteFile:function(e){window.nim.deleteFile({docId:e,error:function(e,t){console.error("deleteFile error",e,t)},success:function(){console.log("deleteFile success");var t={docId:e,percent:0,state:a.serializeFileStateMap.TRANSING};r.StoreWhiteBoard.setFileState(t),r.StoreWhiteBoard.deleteFile(e)}})},getFile:function(e){window.nim.getFile({docId:e,success:function(e){console.log("getFile success",e)},error:function(e){console.error("getFile error",e)}})},getFileList:function(){console.log("getFileList"),window.nim.getFileList({limit:30,success:function(e){console.log("getFileList success",e),r.StoreWhiteBoard.setFileList({list:e.list,count:e.totalCount})},error:function(e){console.error("getFileList error",e)}})},syncBegin:function(){this.drawPlugin&&this.drawPlugin.syncBegin()},syncRequest:function(e){this.drawPlugin&&this.drawPlugin.syncRequest(e)}}},461:function(e,t,o){},463:function(e,t,o){},465:function(e,t,o){},477:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});c(o(1)),o(13);var n=c(o(560)),r=c(o(642)),a=c(o(643)),i=c(o(645));function c(e){return e&&e.__esModule?e:{default:e}}var l={home:n.default,login:r.default,main:a.default,regist:i.default};t.default=[{path:"/login",exact:!0,component:l.login},{path:"/regist",exact:!0,component:l.regist},{path:"/",exact:!0,component:l.home},{path:"/home",exact:!0,component:l.home},{path:"/main",exact:!0,component:l.main}]},478:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e.url||!e.data)return Promise.reject("参数不完整，无法发起请求");e.dataType=e.dataType||"json",e.dataType=e.dataType.toLowerCase();var t=new XMLHttpRequest;t.timeout=2e4,t.open(e.type||"GET",e.url,!0),t.responseType=""+e.dataType,t.setRequestHeader("Content-type",r[e.dataType]);t.setRequestHeader("appkey",n.default.appkey);return new Promise(function(o,n){t.onload=function(){var n=t.response;"form"===e.dataType&&(n=JSON.parse(n)),o(n)},t.onerror=function(e){console.error("xhr error",e),n("请求错误，请重试")},t.ontimeout=function(e){console.error("xhr timeout",e),n("请求超时，请重试")},"json"===e.dataType?t.send(JSON.stringify(e.data)):"form"===e.dataType&&t.send(a(e.data))})};var n=function(e){return e&&e.__esModule?e:{default:e}}(o(75));var r={json:"application/json;charset=UTF-8",form:"application/x-www-form-urlencoded"},a=function(e){return Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(/Object/i.test(e[t])?JSON.stringify(e[t]):e[t])}).join("&")}},479:function(e,t,o){"use strict";var n=a(o(480)),r=(a(o(197)),a(o(195)));function a(e){return e&&e.__esModule?e:{default:e}}({init:function(){this.initMobile().then(function(){})},lazyLoad:function(){(0,r.default)(["lib/md5.js","lib/qs.min.js","lib/axios.min.js"])},initMobile:function(){return/(ios|android)/gi.test(n.default.os.family)?(0,r.default)("lib/vconsole.min.js").then(function(){console.log(n.default)}):Promise.resolve()}}).init()},481:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=window.sessionStorage||window.localStorage;t.default={get:function(e){return n.getItem(e)},set:function(e,t){e&&n.setItem(e,t)},remove:function(e){n.removeItem(e)},clean:function(){n.clear&&n.clear()}}},482:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AlertCtrl=t.Alert=void 0;var n=a(o(199)),r=a(o(550));function a(e){return e&&e.__esModule?e:{default:e}}t.Alert=n.default,t.AlertCtrl=r.default},498:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=c(r),i=c(o(7));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=e.children,o=e.className,n=(e.title,e.onClick),r=e.loading,c=e.disabled;return a.default.createElement("button",{className:(0,i.default)("u-btn",o),disabled:c?"disabled":"",onClick:n},r&&a.default.createElement("i",{className:"u-loading"}),t)}}]),t}();t.default=l},499:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=c(r),i=c(o(7));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=e.children,o=e.className,n=(e.title,e.option,e.onClick),r=e.spacing,c=void 0!==r&&r;return a.default.createElement("div",{className:(0,i.default)("u-grid-row",o,c?"spacing":""),onClick:n},t)}}]),t}();t.default=l},500:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=c(r),i=c(o(7));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=e.children,o=e.className,n=e.span,r=e.onClick,c=e.spacing,l=void 0!==c&&c;return a.default.createElement("div",{className:(0,i.default)("u-grid-col",o,"flex-"+(n||12),l?"spacing":""),onClick:r},t)}}]),t}();t.default=l},501:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=c(r),i=c(o(7));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=(e.children,e.className),o=e.onChange,n=e.onBlur,r=e.onFocus,c=e.onKeyDown,l=e.placeholder,s=e.value,u=e.type,f=e.name,d=e.domRef,m=e.maxLength,p=e.accept,h=e.multiple;return a.default.createElement("input",{name:f,className:(0,i.default)("u-input",t),type:u,onChange:o,onBlur:n,onFocus:r,onKeyDown:c,placeholder:l,value:s,ref:d,maxLength:m,accept:p,multiple:h})}}]),t}();t.default=l},502:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=c(r),i=c(o(7));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=(e.children,e.className),o=e.onChange,n=e.onBlur,r=e.onKeyDown,c=e.placeholder,l=e.value;return a.default.createElement("textarea",{className:(0,i.default)("u-textarea",t),onChange:o,onBlur:n,onKeyDown:r,placeholder:c,value:l})}}]),t}();t.default=l},503:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=l(r),i=(l(o(7)),o(23),l(o(206))),c=o(13);function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u={message:null,visible:!1},f=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.count=0,n.state=u,s(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentWillMount",value:function(){var e=Object.assign({},this.props,{visible:!0});this.setState(e)}},{key:"componentDidMount",value:function(){console.log("tip componentDidMount",this.state),this.checkTimer()}},{key:"componentWillReceiveProps",value:function(e){if(!this.count){Object.assign({},e);this.setState(e)}}},{key:"shouldComponentUpdate",value:function(){return!this.count}},{key:"onClick",value:function(e){var t=e.onClick;this.hide(),c.Valid.isFunction(t)&&t(e)}},{key:"checkTimer",value:function(){var e=this,t=this.state.time,o=this.props.onClose;t&&(t=+t,setTimeout(function(){e.hide(),o&&o()},1e3*+t))}},{key:"hide",value:function(){var e=this;return console.log("tip hide",this.state),this.setState({visible:!1}),setTimeout(function(){return e.count=1},300),this}},{key:"render",value:function(){var e=this.state,t=(e.className,e.message,e.close),o=e.visible,n=this.state;return n.onClick=this.onClick.bind(this,{onClick:t}),o&&a.default.createElement(i.default,n)}}]),t}();t.default=f},504:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=c(r),i=c(o(7));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=e.children,o=e.className,n=e.title;return a.default.createElement("div",{className:(0,i.default)("u-tooltip",o)},t,n&&a.default.createElement("div",{className:"u-tooltip-title"},n))}}]),t}();t.default=l},505:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.children;var t=e.className,o=e.percent;return e.visible&&n.default.createElement("div",{className:(0,r.default)("u-progress",t)},n.default.createElement("p",{className:(0,r.default)("u-progress-state"),style:{width:o+"%"}}))};var n=a(o(1)),r=a(o(7));function a(e){return e&&e.__esModule?e:{default:e}}},506:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=c(r),i=c(o(7));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=e.children,o=e.className,n=e.onClick,r=e.disable,c=e.active;return a.default.createElement("i",{className:(0,i.default)("u-icon iconfont",o,c?"active":""),disable:r,onClick:n},t)}}]),t}();t.default=l},507:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=l(a),c=l(o(7));function l(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentWillReceiveProps",value:function(e){e.visible&&this.setState({hidden:!e.visible})}},{key:"render",value:function(){var e=this.props,t=e.visible,o=e.className,r=function(e,t){var o={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(o[n]=e[n]);return o}(e,["visible","className"]);return i.default.createElement("div",n({hidden:!t,className:(0,c.default)("u-mask",o)},r))}}]),t}();t.default=s},508:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=function(e){return e&&e.__esModule?e:{default:e}}(r);function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),c=0;c<r;c++)a[c]=arguments[c];return o=n=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.id=null,n.state={totalPage:0,currPage:0},n.goPrev=function(e){var t=n.state;if(!(t.currPage<=1)){var o=t.currPage-1;n.setPage(o)}},n.goNext=function(e){var t=n.state;if(!(t.currPage>=t.totalPage)){var o=t.currPage+1;n.setPage(o)}},i(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentWillMount",value:function(){this.setNewState(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.setNewState(e)}},{key:"setNewState",value:function(e){this.id!==e.id&&this.setState({totalPage:+e.totalPage,currPage:+e.currPage})}},{key:"setPage",value:function(e){console.log("setPage",e),this.setState({currPage:e}),this.props.onChange&&this.props.onChange(e)}},{key:"render",value:function(){var e=this.state,t=e.totalPage,o=e.currPage;return a.default.createElement("div",null,a.default.createElement("div",{className:"u-pagination"},a.default.createElement("a",{className:"u-icon iconfont icon-back "+(o<=1?"disable":""),onClick:this.goPrev}),a.default.createElement("span",{className:"u-pagination-text"},o," / ",t),a.default.createElement("a",{className:"u-icon iconfont icon-more "+(o>=t?"disable":""),onClick:this.goNext})))}}]),t}();t.default=c},509:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=u(r),i=u(o(7)),c=(u(o(75)),u(o(207))),l=o(11),s=u(o(25));function u(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}l.StoreNim.state,l.StoreNim,l.StoreChatroom.state;var d=l.StoreChatroom,m=(l.StoreNetcall.state,l.StoreNetcall,function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={emoji:n.genEmojiList("emoji",c.default.emojiList),pinup:n.genEmojiList("pinup",c.default.pinupList),currType:"emoji",currAlbum:"emoji",currEmoji:[]},f(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"getCurrEmoji",value:function(e,t){return"emoji"==e?this.state.emoji[t]:"pinup"==e?this.state.pinup[t]:[]}},{key:"selectAlbum",value:function(e){console.log("select -> ",e.type),this.setState({currType:e.type,currAlbum:e.name,currEmoji:this.getCurrEmoji(e.type,e.name)})}},{key:"selectEmoji",value:function(e){console.log("选中条目:",e),"emoji"==e.type?(console.log("添加一个表情文案到输入框： "),this.props.fn&&this.props.fn(e.key),d.setShowEmojiPanel(!1)):(console.log("发送贴图消息"),s.default.sendPinupMsg(e.name,e.key).then(function(){console.log("贴图消息发送成功..."),d.setShowEmojiPanel(!1)}).catch(function(e){console.log("贴图消息发送失败..."),d.setShowEmojiPanel(!1)}))}},{key:"genEmojiList",value:function(e,t){var o={};for(var n in t){var r=t[n],a=[];for(var i in r)a.push({type:e,name:n,key:i,img:r[i].img});a.length>0&&(o[n]={type:e,name:n,list:a,album:a[0].img})}return console.log(o),o}},{key:"componentDidMount",value:function(){console.log("emojiPanel componentDidMount ... "),this.setState({currEmoji:this.getCurrEmoji(this.state.currType,this.state.currAlbum)})}},{key:"render",value:function(){var e=this,t=this.state;return a.default.createElement("div",{className:"m-emoji"},a.default.createElement("div",{className:"emoji-tab"},Object.keys(t.emoji).map(function(o){return a.default.createElement("div",{key:"emoji-"+o,className:(0,i.default)("emoji-tab-item",t.emoji[o].name==t.currAlbum?"active":""),onClick:e.selectAlbum.bind(e,t.emoji[o])},a.default.createElement("img",{src:t.emoji[o].album}))}),Object.keys(t.pinup).map(function(o){return a.default.createElement("div",{key:"pinup-"+o,className:(0,i.default)("emoji-tab-item",t.pinup[o].name==t.currAlbum?"active":""),onClick:e.selectAlbum.bind(e,t.pinup[o])},a.default.createElement("img",{src:t.pinup[o].album}))})),a.default.createElement("div",{className:"emoji-content"},t.currEmoji&&t.currEmoji.list&&t.currEmoji.list.map(function(o,n){return a.default.createElement("span",{key:t.currAlbum+"-"+n,className:(0,i.default)("emoji-item","pinup"==t.currType?"emoji-pinup-item":""),onClick:e.selectEmoji.bind(e,o)},a.default.createElement("img",{src:o.img+"?imageView&thumbnail="+("emoji"==t.currType?"28x28":"48x48")}))})))}}]),t}());t.default=m},510:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=o(21),c=(function(e){e&&e.__esModule}(o(104)),o(13));function l(e,t,o,n,r){var a={};return Object.keys(n).forEach(function(e){a[e]=n[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}(0,i.useStrict)(!0),console.log("Storage",Storage),console.log("Logger",c.Logger);var s=(n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}(this,"state",r,this)}return a(e,[{key:"setHasReceiveHostMsg",value:function(e){this.state.hasReceiveHostMsg=e,console.log("store --\x3e nim --\x3e setHasReceiveHostMsg",e)}},{key:"setNim",value:function(e){console.log("store --\x3e nim --\x3e setNim",e),this.state.nim=e}},{key:"setUid",value:function(e){console.log("store --\x3e nim --\x3e setUid",e),this.state.uid=e}},{key:"setAccount",value:function(e){console.log("store --\x3e nim --\x3e setAccount",e),this.state.account=e}},{key:"setToken",value:function(e){console.log("store --\x3e nim --\x3e setToken",e),this.state.token=e}}]),e}(),r=l(n.prototype,"state",[i.observable],{enumerable:!0,initializer:function(){return{account:"",token:"",nim:null,hasReceiveHostMsg:!1}}}),l(n.prototype,"setHasReceiveHostMsg",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setHasReceiveHostMsg"),n.prototype),l(n.prototype,"setNim",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setNim"),n.prototype),l(n.prototype,"setUid",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setUid"),n.prototype),l(n.prototype,"setAccount",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setAccount"),n.prototype),l(n.prototype,"setToken",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setToken"),n.prototype),n);t.default=s},511:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=o(21),c=(function(e){e&&e.__esModule}(o(104)),o(13));function l(e,t,o,n,r){var a={};return Object.keys(n).forEach(function(e){a[e]=n[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}(0,i.useStrict)(!0);var s=(n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}(this,"state",r,this)}return a(e,[{key:"setLastTimestamp",value:function(e){this.state.lastTimestamp=e,console.log("store --\x3e chatroom --\x3e setLastTimestamp",e)}},{key:"setCustom",value:function(e){this.state.custom=e,console.log("store --\x3e chatroom --\x3e setCustom",e)}},{key:"setCanLoadHistory",value:function(e){this.state.canLoadHistory=e,console.log("store --\x3e chatroom --\x3e setCanLoadHistory",e)}},{key:"setShowEmojiPanel",value:function(e){this.state.showEmojiPanel=e,console.log("store --\x3e chatroom --\x3e setShowEmojiPanel",e)}},{key:"setIsShowMemberTab",value:function(e){this.state.isShowMemberTab=e,console.log("store --\x3e chatroom --\x3e setIsShowMemberTab",e)}},{key:"setHasPermissionRequest",value:function(e){this.state.hasPermissionRequest=e,console.log("store --\x3e chatroom --\x3e setHasPermissionRequest",e)}},{key:"hasPermissionRequestMember",value:function(){return-1!=this.state.members.findIndex(function(e,t){return 2==e.status})}},{key:"setCurrChatroomId",value:function(e){this.state.currChatroomId=e,console.log("store --\x3e chatroom --\x3e setCurrChatroomId",e)}},{key:"setChatroom",value:function(e,t){e&&(this.state.currChatroom=t,console.log("store --\x3e chatroom --\x3e setChatroom",t))}},{key:"setMsgs",value:function(e){e&&(c.Valid.isArray(e)?(this.state.msgs=this.state.msgs.concat(e),console.log("store --\x3e chatroom --\x3e setMsgs",e)):console.error("非消息数组",e))}},{key:"addHistoryMsgs",value:function(e){if(e)if(c.Valid.isArray(e)){var t=[];e.forEach(function(e){t.unshift(e)}),this.state.msgs=t.concat(this.state.msgs),console.log("store --\x3e chatroom --\x3e addHistoryMsgs",e)}else console.error("非消息数组",e)}},{key:"clearMsgs",value:function(){this.state.msgs=[],console.log("store --\x3e chatroom --\x3e clearMsgs")}},{key:"setMembers",value:function(e){e&&(c.Valid.isArray(e)?(this.state.members=this.state.members.concat(e),console.log("store --\x3e chatroom --\x3e setMembers",e),this.resortMemberLocation()):console.error("非成员数组",e))}},{key:"clearMembers",value:function(){this.state.members=[],console.log("store --\x3e chatroom --\x3e clearMembers",this.state.members)}},{key:"findMember",value:function(e){return this.state.members.findIndex(function(t,o){return e.account==t.account})}},{key:"addMember",value:function(e){if(e){var t=this.findMember(e);-1==t?(this.state.members.push(e),console.log("store --\x3e chatroom --\x3e addMember",e),this.resortMemberLocation()):console.log("已存在的成员：",e,", idx: ",t)}}},{key:"delMember",value:function(e){if(e){var t=this.findMember({account:e});-1!=t?(this.state.members.splice(t,1),console.log("store --\x3e chatroom --\x3e delMember",e),this.resortMemberLocation()):console.log("不存在的成员：",e," 删除失败")}}},{key:"setMemberStatus",value:function(e,t){if(e){var o=this.findMember({account:e});if(-1!=o){var n=this.state.members[o];n.status=t,this.state.members.splice(o,1,n),console.log("store --\x3e chatroom --\x3e setMemberStatus",e,t),this.resortMemberLocation()}else console.log("不存在的成员：",e," 设置成员互动状态失败")}}},{key:"setMemberAudioVolume",value:function(e,t){if(e){var o=this.findMember({account:e});if(-1!=o){var n=this.state.members[o];n.audioVolume=t,this.state.members.splice(o,1,n)}}}},{key:"setType",value:function(e){this.state.type=e,console.log("store --\x3e chatroom --\x3e setType",e)}},{key:"resortMemberLocation",value:function(){var e=null,t=[],o=[],n=[];this.state.members.forEach(function(n){"owner"==n.type?e=n:1==n.status||2==n.status?t.push(n):o.push(n)}),o.sort(function(e,t){return e.enterTime<t.enterTime?-1:e.enterTime>t.enterTime?1:0}),n=t.concat(o),null!=e&&n.unshift(e),this.state.members=n,console.log("store --\x3e chatroom --\x3e resortMemberLocation",n)}}]),e}(),r=l(n.prototype,"state",[i.observable],{enumerable:!0,initializer:function(){return{lastTimestamp:0,canLoadHistory:!0,showEmojiPanel:!1,isShowMemberTab:!1,currChatroomId:"",currChatroom:null,hasPermissionRequest:!1,msgs:[],members:[],type:"",custom:{}}}}),l(n.prototype,"setLastTimestamp",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setLastTimestamp"),n.prototype),l(n.prototype,"setCustom",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setCustom"),n.prototype),l(n.prototype,"setCanLoadHistory",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setCanLoadHistory"),n.prototype),l(n.prototype,"setShowEmojiPanel",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setShowEmojiPanel"),n.prototype),l(n.prototype,"setIsShowMemberTab",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setIsShowMemberTab"),n.prototype),l(n.prototype,"setHasPermissionRequest",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setHasPermissionRequest"),n.prototype),l(n.prototype,"setCurrChatroomId",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setCurrChatroomId"),n.prototype),l(n.prototype,"setChatroom",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setChatroom"),n.prototype),l(n.prototype,"setMsgs",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setMsgs"),n.prototype),l(n.prototype,"addHistoryMsgs",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"addHistoryMsgs"),n.prototype),l(n.prototype,"clearMsgs",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"clearMsgs"),n.prototype),l(n.prototype,"setMembers",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setMembers"),n.prototype),l(n.prototype,"clearMembers",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"clearMembers"),n.prototype),l(n.prototype,"addMember",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"addMember"),n.prototype),l(n.prototype,"delMember",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"delMember"),n.prototype),l(n.prototype,"setMemberStatus",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setMemberStatus"),n.prototype),l(n.prototype,"setMemberAudioVolume",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setMemberAudioVolume"),n.prototype),l(n.prototype,"setType",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setType"),n.prototype),n);t.default=s},512:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=o(21);function c(e,t,o,n,r){var a={};return Object.keys(n).forEach(function(e){a[e]=n[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}(0,i.useStrict)(!0);var l=(n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}(this,"state",r,this)}return a(e,[{key:"setShareStarted",value:function(e){this.state.shareStarted=e,console.log("store --\x3e chatroom --\x3e setShareStarted",e)}},{key:"setChromeDown",value:function(e){this.state.chromeDown=e,console.log("store --\x3e chatroom --\x3e setChromeDown",e)}},{key:"settabindex",value:function(e){this.state.tabIndex=e,console.log("store --\x3e netcall --\x3e settabIndex",e)}},{key:"setHasVideo",value:function(e){this.state.hasVideo=e,console.log("store --\x3e netcall --\x3e setHasVideo",e)}},{key:"setHasAudio",value:function(e){this.state.hasAudio=e,console.log("store --\x3e netcall --\x3e setHasAudio",e)}},{key:"setHasShareScreen",value:function(e){this.state.hasShareScreen=e,console.log("store --\x3e netcall --\x3e sethasShareScreen",e)}},{key:"setVideo4ScreenShareing",value:function(e){this.state.video4ScreenSharing=e,console.log("store --\x3e netcall --\x3e setVideo4ScreenShareing",e)}},{key:"setScreenShareing4Local",value:function(e){this.state.screenShareing4Local=e,console.log("store --\x3e netcall --\x3e setScreenShareing4Local",e)}},{key:"resortMembers",value:function(){var e=[];this.state.members.forEach(function(t){""!=t.account&&e.push(t)}),this.addMemberIfNotFull(e),this.state.members=e,console.log("store --\x3e netcall --\x3e resortMembers",e)}},{key:"setFromCreate",value:function(e){this.state.fromCreate=e,console.log("store --\x3e netcall --\x3e setFromCreate",e)}},{key:"setShowStatus",value:function(e){this.state.showStatus=e,console.log("store --\x3e netcall --\x3e setShowStatus",e)}},{key:"setDoms",value:function(e){this.state.doms=e,console.log("store --\x3e netcall --\x3e setDoms",e)}},{key:"clearDoms",value:function(){this.state.doms=[],console.log("store --\x3e netcall --\x3e clearDoms")}},{key:"addDom",value:function(e){var t=e&&e.id?e.id:"";if(t){var o=this.state.doms.findIndex(function(e,o){if(e.id&&e.id==t)return o});-1==o?(this.state.doms.push(e),console.log("store --\x3e netcall --\x3e addDom",e)):console.error("已存在对应的DOM节点，不重复追加...",o)}else console.error("不存在的DOM节点或id属性：",t)}},{key:"setWebRtc",value:function(e){this.state.webrtc=e,console.log("store --\x3e netcall --\x3e setWebRtc",e)}},{key:"setHasPermission",value:function(e){this.state.hasPermission=e,console.log("store --\x3e netcall --\x3e setHasPermission",e)}},{key:"findMember",value:function(e){return this.state.members.findIndex(function(t,o){return t.account==e.account})}},{key:"clearMembers",value:function(){this.state.members=[{account:"",self:!1},{account:"",self:!1},{account:"",self:!1},{account:"",self:!1}],console.log("store --\x3e netcall --\x3e clearMembers")}},{key:"setMembers",value:function(e){e&&(this.addMemberIfNotFull(e),this.state.members=e,console.log("store --\x3e netcall --\x3e setMembers",e))}},{key:"addMemberIfNotFull",value:function(e){var t=e.length<4?4-e.length:0;if(t>0)for(var o=0,n=t;o<n;o++)e.push({account:"",self:!1})}},{key:"canAddNewMember",value:function(){var e=0;return this.state.members.forEach(function(t){t.account&&""!=t.account&&(e+=1)}),console.log("是否可继续加人互动：",e,4==e),4==e}},{key:"addMember",value:function(e,t,o){if(-1!=this.findMember(e))return console.log("已存在的音视频成员",e),void(t&&(console.log("额外设置老师状态..."),this.setTeacherStatus(e.account,o)));var n=this.state.members.findIndex(function(e){return""==e.account});-1!=n?(console.log("***** 要放置人员最近一个空位置为：",n),this.state.members.splice(n,1,e),console.log("store --\x3e netcall --\x3e addMember",e)):console.log("已有4个成员，无法再加")}},{key:"delMember",value:function(e){var t=this.findMember({account:e});-1!=t?(this.state.members.splice(t,1,{account:"",self:!1}),console.log("store --\x3e netcall --\x3e delMember",e),this.resortMembers()):console.log("不存在的音视频成员",e)}},{key:"setTeacherStatus",value:function(e,t){var o=this.findMember({account:e});if(-1!=o){var n=this.state.members[o];n.offline=t,this.state.members.splice(o,1,n),console.log("store --\x3e netcall --\x3e setTeacherStatus",e,t)}else console.log("不存在的音视频成员",e)}},{key:"setVideo",value:function(e){this.state.video=e,console.log("store --\x3e netcall --\x3e setVideo",e)}},{key:"setAudio",value:function(e){this.state.audio=e,console.log("store --\x3e netcall --\x3e setAudio",e)}}]),e}(),r=c(n.prototype,"state",[i.observable],{enumerable:!0,initializer:function(){return{video4ScreenSharing:!1,screenShareing4Local:!1,doms:[],fromCreate:!1,hasPermission:!1,showStatus:0,webrtc:null,members:[{account:"",self:!1,offline:!0},{account:"",self:!1},{account:"",self:!1},{account:"",self:!1}],video:!0,audio:!0,hasVideo:!1,hasAudio:!1,setHasShareScreen:!1,tabIndex:0,shareStarted:!1,chromeDown:!1}}}),c(n.prototype,"setShareStarted",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setShareStarted"),n.prototype),c(n.prototype,"setChromeDown",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setChromeDown"),n.prototype),c(n.prototype,"settabindex",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"settabindex"),n.prototype),c(n.prototype,"setHasVideo",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setHasVideo"),n.prototype),c(n.prototype,"setHasAudio",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setHasAudio"),n.prototype),c(n.prototype,"setHasShareScreen",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setHasShareScreen"),n.prototype),c(n.prototype,"setVideo4ScreenShareing",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setVideo4ScreenShareing"),n.prototype),c(n.prototype,"setScreenShareing4Local",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setScreenShareing4Local"),n.prototype),c(n.prototype,"resortMembers",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"resortMembers"),n.prototype),c(n.prototype,"setFromCreate",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setFromCreate"),n.prototype),c(n.prototype,"setShowStatus",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setShowStatus"),n.prototype),c(n.prototype,"setDoms",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setDoms"),n.prototype),c(n.prototype,"clearDoms",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"clearDoms"),n.prototype),c(n.prototype,"addDom",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"addDom"),n.prototype),c(n.prototype,"setWebRtc",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setWebRtc"),n.prototype),c(n.prototype,"setHasPermission",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setHasPermission"),n.prototype),c(n.prototype,"clearMembers",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"clearMembers"),n.prototype),c(n.prototype,"setMembers",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setMembers"),n.prototype),c(n.prototype,"addMember",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"addMember"),n.prototype),c(n.prototype,"delMember",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"delMember"),n.prototype),c(n.prototype,"setTeacherStatus",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setTeacherStatus"),n.prototype),c(n.prototype,"setVideo",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setVideo"),n.prototype),c(n.prototype,"setAudio",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setAudio"),n.prototype),n);t.default=l},513:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=o(21),c=function(e){return e&&e.__esModule?e:{default:e}}(o(104));function l(e,t,o,n,r){var a={};return Object.keys(n).forEach(function(e){a[e]=n[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}(0,i.useStrict)(!0);var s=(n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}(this,"state",r,this)}return a(e,[{key:"reset",value:function(){console.log("store --\x3e wb --\x3e reset"),this.state.fileList=[],this.state.currentFile=null,this.state.fileListCount=0,this.state.currentDrawMode="free",this.state.currentDrawColor="#000",this.state.fileKitEnable=!1}},{key:"setContainer",value:function(e){console.log("store --\x3e wb --\x3e setContainer",e),this.state.node=e}},{key:"setStatus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("store --\x3e wb --\x3e setStatus",e),this.state=Object.assign(this.state,e)}},{key:"setColor",value:function(e){console.log("store --\x3e wb --\x3e setColor",e),this.state.currentDrawColor=e}},{key:"setStyle",value:function(e){console.log("store --\x3e wb --\x3e setStyle",e),this.state.style=e}},{key:"setFileKitEnable",value:function(e){console.log("store --\x3e wb --\x3e setFileKitEnable",e),this.state.fileKitEnable=!!e}},{key:"setFileInput",value:function(e){console.log("store --\x3e wb --\x3e setFileInput",e),this.state.fileInput=e}},{key:"setCurrentFile",value:function(e){if(console.log("store --\x3e wb --\x3e setCurrentFile docId",e),e){var t=this.state.fileList.find(function(t){return t.docId===e});this.state.currentFile=t,t&&(t.currentPage=1)}}},{key:"setCurrentFilePage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.state.currentFile&&(this.state.currentFile.currentPage=e,console.log("store --\x3e wb --\x3e setCurrentFilePage index",e,this.state.currentFile))}},{key:"deleteFile",value:function(e){if(console.log("store --\x3e wb --\x3e deleteFile docId",e),e){var t=this.state.fileList.findIndex(function(t){return t.docId===e});-1!==t&&this.state.fileList.splice(t,1)}}},{key:"addFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(console.log("store --\x3e wb --\x3e addFile docId",e),e.docId)&&(-1===this.state.fileList.findIndex(function(t){return t.docId===e.docId})&&this.state.fileList.unshift(e))}},{key:"setFileState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.docId;if(t){var o=this.state,n=o.fileList.find(function(e){return e.docId===t});n&&(n=Object.assign(n,e),console.log("store --\x3e wb --\x3e setFileState",e),n.mime&&!n.type&&(n.type=o.unserializefileTypeMap[n.mime]),n.state-2==0?this.startFileProgress(n.docId):/(2|11)/.test(n.state)||(n.percent=0,n.timer&&clearInterval(n.timer),n.timer=null))}else console.error("设置文件状态失败，参数缺失docId")}},{key:"startFileProgress",value:function(e){var t=this;if(console.log("store --\x3e wb --\x3e startFileProgress",e),e){var o=this.state.fileList.find(function(t){return t.docId===e});o&&!o.timer&&(o.timeStart=Date.now(),o.timer=setInterval(function(){if(!t.state.fileList.find(function(t){return t.docId===e})||/[345]/.test(o.state)||o.percent>99){var n=o.percent>99?99.99:0;return t.setFileProgress(e,n),clearInterval(o.timer),void(o.timer=null)}var r=Math.floor((Date.now()-o.timeStart)/1e3);r=100*(1-Math.pow(.97716,r)),t.setFileProgress(e,r.toFixed(2))},1e3))}}},{key:"setFileProgress",value:function(e,t){var o=this.state.fileList.find(function(t){return t.docId===e});o&&(o.percent=t,console.log("setFileProgress",e,o.name,o.percent))}},{key:"setFileList",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=t.list,n=void 0===o?[]:o,r=t.count,a=void 0===r?0:r;this.state.fileList=n,a&&(this.state.fileListCount=a),n.map(function(t){t.state-2==0&&e.setFileProgress(t.docId,99.99)}),console.log("store --\x3e wb --\x3e setFileList",this.state.fileList)}},{key:"setDrawMode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"free";console.log("store --\x3e wb --\x3e setDrawMode",e),/(flag|free)/.test(e)&&(this.state.currentDrawMode=e)}},{key:"setDrawColor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#000";console.log("store --\x3e wb --\x3e setDrawColor",e),this.state.currentDrawColor=e}},{key:"setFileTip",value:function(e){console.log("store --\x3e wb --\x3e setFileTip",e),this.state.showFileTip=!!e}}]),e}(),r=l(n.prototype,"state",[i.observable],{enumerable:!0,initializer:function(){return Object.assign({},c.default.wbInfo,{serializeFileStateMap:c.default.serializeFileStateMap,unserializeFileStateMap:c.default.unserializeFileStateMap,unserializeFileStateText:c.default.unserializeFileStateText,fileTypeMap:c.default.fileTypeMap,fileInput:null,fileKitEnable:!1,serializefileTypeMap:c.default.serializefileTypeMap,unserializefileTypeMap:c.default.unserializefileTypeMap,currentFile:null,fileList:[],fileListCount:0,colorList:["#000","#35CBFF","#FFDD3F","#FF553C","#61D25C","#B65CFF"],currentDrawMode:"free",currentDrawColor:"#000",showFileTip:!0})}}),l(n.prototype,"reset",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"reset"),n.prototype),l(n.prototype,"setContainer",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setContainer"),n.prototype),l(n.prototype,"setStatus",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setStatus"),n.prototype),l(n.prototype,"setColor",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setColor"),n.prototype),l(n.prototype,"setStyle",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setStyle"),n.prototype),l(n.prototype,"setFileKitEnable",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setFileKitEnable"),n.prototype),l(n.prototype,"setFileInput",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setFileInput"),n.prototype),l(n.prototype,"setCurrentFile",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setCurrentFile"),n.prototype),l(n.prototype,"setCurrentFilePage",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setCurrentFilePage"),n.prototype),l(n.prototype,"deleteFile",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"deleteFile"),n.prototype),l(n.prototype,"addFile",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"addFile"),n.prototype),l(n.prototype,"setFileState",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setFileState"),n.prototype),l(n.prototype,"startFileProgress",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"startFileProgress"),n.prototype),l(n.prototype,"setFileProgress",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setFileProgress"),n.prototype),l(n.prototype,"setFileList",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setFileList"),n.prototype),l(n.prototype,"setDrawMode",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setDrawMode"),n.prototype),l(n.prototype,"setDrawColor",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setDrawColor"),n.prototype),l(n.prototype,"setFileTip",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setFileTip"),n.prototype),n);t.default=s},514:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=o(21);(function(e){e&&e.__esModule})(o(104)),o(13);function c(e,t,o,n,r){var a={};return Object.keys(n).forEach(function(e){a[e]=n[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}(0,i.useStrict)(!0);var l=(n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}(this,"state",r,this)}return a(e,[{key:"clearRemoteTrackNotifications",value:function(){this.state.remoteTrackNotifications={},console.log("store --\x3e eventpool --\x3e clearRemoteTrackNotifications")}},{key:"addRemoteTrackNotification",value:function(e){this.state.remoteTrackNotifications[e]?console.log("已通知的远程轨道：",e):(this.state.remoteTrackNotifications[e]=1,console.log("store --\x3e eventpool --\x3e addRemoteTrackNotification",e))}}]),e}(),r=c(n.prototype,"state",[i.observable],{enumerable:!0,initializer:function(){return{remoteTrackNotifications:{}}}}),c(n.prototype,"clearRemoteTrackNotifications",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"clearRemoteTrackNotifications"),n.prototype),c(n.prototype,"addRemoteTrackNotification",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"addRemoteTrackNotification"),n.prototype),n);t.default=l},515:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmDeviceContent=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(o(516));t.ConfirmDeviceContent=n.default},516:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=u(a),c=u(o(7)),l=o(19),s=o(11);function u(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}s.StoreNim.state,s.StoreNim,s.StoreChatroom.state,s.StoreChatroom;var d=s.StoreNetcall.state,m=s.StoreNetcall,p=(0,l.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.onToggleAudio=function(e){m.setAudio(!d.audio),console.log("切换音频:",d.audio)},n.onToggleVideo=function(e){m.setVideo(!d.video),console.log("切换视频:",d.video)},f(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){return i.default.createElement("div",{className:"u-confirm-device"},i.default.createElement("div",{className:"msg"},i.default.createElement("div",null,"老师已通过你的发言方式，"),i.default.createElement("div",null,"请选择发言方式:")),i.default.createElement("div",{className:"fnlist"},i.default.createElement("div",{className:"fn-part"},i.default.createElement("input",{type:"checkbox",name:"fn",id:"audio",className:"select-checkbox"}),i.default.createElement("label",{className:(0,c.default)("select-item",d.audio?"selected":""),htmlFor:"audio",onClick:this.onToggleAudio},"语音")),i.default.createElement("div",{className:"fn-part"},i.default.createElement("input",{type:"checkbox",name:"fn",id:"video",className:"select-checkbox"}),i.default.createElement("label",{className:(0,c.default)("select-item",d.video?"selected":""),htmlFor:"video",onClick:this.onToggleVideo},"视频")),i.default.createElement("div",{className:"fn-part fn-part-1"},i.default.createElement("input",{type:"checkbox",name:"fn",id:"whiteboard",className:"select-checkbox"}),i.default.createElement("label",{className:"select-item disabled",htmlFor:"whiteboard"},"默认互动白板"))))}}]),t}())||n;t.default=p},517:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=o(19),l=d(o(7)),s=d(o(518)),u=d(o(521)),f=o(11);function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}f.StoreNim.state,f.StoreNim;var p=f.StoreChatroom.state,h=f.StoreChatroom,g=(f.StoreNetcall.state,f.StoreNetcall,(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.showChatPanel=function(e){h.setIsShowMemberTab(!1)},n.showMemberPanel=function(e){h.setIsShowMemberTab(!0),h.setHasPermissionRequest(!1)},m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){var e=this.props;e.children,e.className;return i.default.createElement("div",{className:"m-chatroom"},i.default.createElement("div",{className:"u-tab"},i.default.createElement("div",{className:"u-tab-header"},i.default.createElement("div",{className:(0,l.default)("u-tab-item u-tab-item-small",p.isShowMemberTab?"":"active"),onClick:this.showChatPanel},"讨论"),i.default.createElement("div",{className:(0,l.default)("u-tab-item u-tab-item-small",p.isShowMemberTab?"active":""),onClick:this.showMemberPanel},"成员",!p.isShowMemberTab&&p.hasPermissionRequest&&i.default.createElement("i",{className:"pointer"}," "))),i.default.createElement("div",{className:"u-tab-body"},p.isShowMemberTab?i.default.createElement(u.default,null):i.default.createElement(s.default,null))))}}]),t}())||n);t.default=g},518:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=u(a),c=o(19),l=(u(o(7)),o(23),u(o(519))),s=u(o(520));function u(e){return e&&e.__esModule?e:{default:e}}var f=(0,c.observer)(n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){return i.default.createElement("div",{className:"m-chatroom-chatarea"},i.default.createElement(l.default,null),i.default.createElement(s.default,null))}}]),t}())||n;t.default=f},519:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=o(19),l=d(o(200)),s=(d(o(7)),o(23)),u=o(11),f=(d(o(26)),d(o(25)));d(o(27)),d(o(42));function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}u.StoreNim.state,u.StoreNim;var p=u.StoreChatroom.state,h=u.StoreChatroom,g=(u.StoreNetcall.state,u.StoreNetcall,(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={historyLoading:!1},n.loadHistoryMsg=function(e){console.log("点击加载历史消息按钮..."),n.state.historyLoading?console.log("正在加载中，忽略重复点击 ..."):(n.setState({historyLoading:!0}),f.default.getHistoryMsgs(p.lastTimestamp).then(function(e){console.log("获取聊天室历史消息成功"),h.setCanLoadHistory(!1),e=e.map(function(e){return f.default.formatChatroomMsg(e,!0)}),h.addHistoryMsgs(e)}).catch(function(e){console.error("获取聊天室历史消息失败: ",e),n.setState({historyLoading:!1})}))},m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentDidMount",value:function(){console.log("chat.list componentDidMount: "),h.setLastTimestamp(Date.now())}},{key:"render",value:function(){return i.default.createElement("div",{id:"chat-msg-list",className:"m-chatroom-list"},p.canLoadHistory&&i.default.createElement("div",{className:"history-toolbar"},i.default.createElement(s.Button,{className:"u-btn-none f-w-140",onClick:this.loadHistoryMsg,loading:this.state.historyLoading},"加载历史消息")),p.msgs.map(function(e,t){return e&&"notification"==e.type?i.default.createElement("div",{key:t,className:"msg msg-notification"},e.content):e&&"text"==e.type?i.default.createElement("div",{key:t,className:"msg"},e.avatar?i.default.createElement("div",{className:"avatar",style:{backgroundImage:"url("+e.avatar+")"}}):i.default.createElement("div",{className:"avatar"}),i.default.createElement("div",{className:"content"},i.default.createElement("div",{className:"nick"},e.nick),i.default.createElement("div",{className:"value"},(0,l.default)(e.content)))):e&&"caiquan"==e.type?i.default.createElement("div",{key:t,className:"msg"},e.avatar?i.default.createElement("div",{className:"avatar",style:{backgroundImage:"url("+e.avatar+")"}}):i.default.createElement("div",{className:"avatar"}),i.default.createElement("div",{className:"content"},i.default.createElement("div",{className:"nick"},e.nick),i.default.createElement("div",{className:"value"},i.default.createElement("img",{src:e.content,style:{width:50,height:50}})))):e&&"emoji"==e.type?i.default.createElement("div",{key:t,className:"msg"},e.avatar?i.default.createElement("div",{className:"avatar",style:{backgroundImage:"url("+e.avatar+")"}}):i.default.createElement("div",{className:"avatar"}),i.default.createElement("div",{className:"content"},i.default.createElement("div",{className:"nick"},e.nick),i.default.createElement("div",{className:"value"},i.default.createElement("img",{src:e.content,style:{width:"emoji"==e.catalog?28:48,height:"emoji"==e.catalog?28:48}})))):""}))}}]),t}())||n);t.default=g},520:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=o(19),l=(d(o(7)),o(23)),s=o(13),u=o(11),f=d(o(25));function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}u.StoreNim.state,u.StoreNim;var p=u.StoreChatroom.state,h=u.StoreChatroom,g=(u.StoreNetcall.state,u.StoreNetcall,(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={msg:"",sendLoading:!1,canSendMsg:!1,showEmojiPanel:!1},n.changeMsg=function(e){var t=e.target.value;s.Valid.isBlank(t)?n.setState({msg:"",canSendMsg:!1}):n.setState({msg:e.target.value,canSendMsg:!0})},n.sendMsg=function(e){console.log("sendMsg ...");var t=s.Valid.removeSpace(n.state);s.Valid.param(t,"msg")?f.default.sendChatroomMsg(n.state.msg).then(function(){console.log("发送消息成功"),n.setState({msg:""})}).catch(function(e){console.error("发送消息失败",e),(0,s.Toast)({msg:"发送消息失败"})}):(0,s.Toast)({msg:"请输入聊天内容"})},n.sendCqMsg=function(e){console.log("发送猜拳消息"),f.default.sendCqMsg().then(function(){console.log("猜拳发送成功...")}).catch(function(e){console.error("猜拳发送失败...",e)})},n.toggleBqPanel=function(e){console.log("表情面板显示/隐藏..."),h.setShowEmojiPanel(!p.showEmojiPanel)},n.doAppendEmoji=function(e){console.log("追加表情文案：",e),n.setState(function(t,o){return{msg:t.msg+" "+e,canSendMsg:!0}})},m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){return i.default.createElement("div",{className:"m-chatroom-input"},i.default.createElement(l.TextArea,{className:"msg-input",onChange:this.changeMsg,placeholder:"和大家一起愉快聊天",value:this.state.msg}),i.default.createElement("div",{className:"input-toolbar"},i.default.createElement("div",{className:"part part-1"},i.default.createElement(l.Button,{className:"u-btn u-btn-smaller",onClick:this.sendMsg,disabled:!this.state.canSendMsg,loading:this.state.sendLoading},"发送")),i.default.createElement("div",{className:"part part-2"},i.default.createElement("span",{className:"cq",onClick:this.sendCqMsg})),i.default.createElement("div",{className:"part part-3"},i.default.createElement("span",{className:"emojis",onClick:this.toggleBqPanel}))),p.showEmojiPanel&&i.default.createElement(l.EmojiPanel,{fn:this.doAppendEmoji}))}}]),t}())||n);t.default=g},521:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=h(a),c=o(19),l=h(o(7)),s=o(11),u=o(13),f=h(o(26)),d=h(o(25)),m=h(o(27)),p=h(o(106));function h(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=s.StoreChatroom.state,v=s.StoreChatroom,y=(s.StoreNim.state,s.StoreNim,s.StoreNetcall.state),w=s.StoreNetcall,S=(s.StoreEventPool,s.StoreEventPool.state,(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=g(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.doEndInteraction=function(e){console.log("【结束互动确认弹窗】 --\x3e 确定.."),u.Alert.close(),v.setMemberStatus(e,0),m.default.stopRemoteStream(e),m.default.stopPlayRemoteAudio(e),f.default.sendCustomSysMsg(e,{room_id:b.currChatroomId,command:12}).then(function(){console.log("主持人通知成员关闭连麦结果成功"),w.delMember(e),m.default.reDrawVideos();var t=[];y.members.forEach(function(e){e.account&&""!=e.account&&t.push(e.account)}),console.log("待通知有权限列表为：",t),d.default.sendCustomMsg({room_id:b.currChatroomId,command:1,uids:t}).then(function(){console.log("[停止互动后]主持人通知成员有权限的成员列表成功")}).catch(function(e){console.error("[停止互动后]主持人通知成员有权限的成员列表失败",e)})}).catch(function(e){console.error("主持人通知成员关闭连麦结果失败",e)})},n.endInteraction=function(e){console.log("结束互动【老师端】",e),u.Alert.open({title:"提示",msg:'<div class="u-end-interaction"><i class="u-icon-tip"></i>确定取消该用户的互动权限？</div>',isHtml:!0,btns:[{label:"确定",clsName:"u-btn-smaller f-mgr-10",onClick:function(){n.doEndInteraction(e)}},{label:"取消",clsName:"u-btn-cancle",onClick:function(){n.doCancle()}}]})},n.doCancle=function(){console.log("【结束互动确认弹窗】 --\x3e 取消.."),u.Alert.close()},n.allowInteraction=function(e){if(w.canAddNewMember())return(0,u.Toast)({msg:"互动人数已满"}),void console.error("不可再加人互动...");console.log("允许互动【老师端】",e),v.setMemberStatus(e,1),w.addMember({account:e,self:!1}),p.default.handleRtcPermissionAndDraw(e),f.default.sendCustomSysMsg(e,{room_id:b.currChatroomId,command:11}).then(function(){console.log("主持人通知成员同意连麦结果成功");var e=[];y.members.forEach(function(t){t.account&&""!=t.account&&e.push(t.account)}),console.log("待通知有权限成员列表为：",e,y.doms.length,y.members.length),d.default.sendCustomMsg({room_id:b.currChatroomId,command:1,uids:e}).then(function(){console.log("[同意互动后]主持人通知成员有权限的成员列表成功")}).catch(function(e){console.error("[同意互动后]主持人通知成员有权限的成员列表失败",e)})}).catch(function(e){console.error("主持人通知成员同意连麦结果失败",e)})},n.getVolume=function(e){return e>0&&e<=.125?"volume-1":e>.125&&e<=.25?"volume-2":e>.25&&e<=.375?"volume-3":e>.375&&e<=.5?"volume-4":e>.5&&e<=.625?"volume-5":e>.625&&e<=.75?"volume-6":e>.75&&e<=.875?"volume-7":e>.875&&e<=1?"volume-8":""},g(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){var e=this,t=u.Storage.get("isTeacher");return i.default.createElement("div",{className:"m-chatroom-list m-chatroom-list-1"},b.members.map(function(o,n){return"owner"==o.type?i.default.createElement("div",{key:n,className:"u-member"},i.default.createElement("div",{className:"owner"}),i.default.createElement("div",{className:(0,l.default)("volume",e.getVolume(o.audioVolume))}),o.avatar?i.default.createElement("div",{className:"avatar",style:{backgroundImage:"url("+o.avatar+")"}}):i.default.createElement("div",{className:"avatar"}),i.default.createElement("div",{className:"nickname"},o.nick)):i.default.createElement("div",{key:n,className:"u-member"},i.default.createElement("div",{className:(0,l.default)("volume",e.getVolume(o.audioVolume))}),o.avatar?i.default.createElement("div",{className:"avatar",style:{backgroundImage:"url("+o.avatar+")"}}):i.default.createElement("div",{className:"avatar"}),i.default.createElement("div",{className:"nickname"},o.nick),i.default.createElement("div",{className:"opt"},1==t&&1==o.status&&i.default.createElement("div",{className:"button button-end",onClick:e.endInteraction.bind(e,o.account)},"结束互动"),1==t&&2==o.status&&i.default.createElement("div",{className:"button",onClick:e.allowInteraction.bind(e,o.account)},"允许互动"),0==t&&1==o.status&&i.default.createElement("div",{className:"interaction-msg"},"互动中...")))}))}}]),t}())||n);t.default=S},522:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=f(a),c=o(19),l=f(o(7)),s=f(o(144)),u=o(11);o(13),f(o(26)),f(o(25)),f(o(27));function f(e){return e&&e.__esModule?e:{default:e}}u.StoreNim.state,u.StoreNim,u.StoreChatroom.state,u.StoreChatroom,u.StoreNetcall.state,u.StoreNetcall;var d=[1,2,3,4],m=(0,c.observer)(n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){var e=this.props,t=(e.children,e.className);return i.default.createElement("div",{className:(0,l.default)("m-netcall",t)},d.map(function(e,t){return i.default.createElement(s.default,{key:t,className:"video-"+(t+1)})}))}}]),t}())||n;t.default=m},523:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=g(a),c=g(o(7)),l=o(19),s=g(o(524)),u=g(o(530)),f=g(o(531)),d=o(13),m=o(11),p=g(o(27)),h=g(o(26));function g(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=m.StoreNim.state,y=(m.StoreNim,m.StoreChatroom.state),w=(m.StoreChatroom,m.StoreNetcall.state),S=m.StoreNetcall,_=(0,l.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=b(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={tabIndex:0},n.showWhiteboardPanel=function(e){w.webrtc&&w.webrtc.startDevice&&!w.hasShareScreen&&(S.settabindex(0),S.setShareStarted(!1),1==d.Storage.get("isTeacher")&&n.startCamera(),y.custom&&(y.custom.fullScreenType=0,h.default.updateChatroom(y.custom)))},n.showScreenSharePanel=function(e){w.webrtc&&w.webrtc.startDevice&&(S.settabindex(1),n.shareScreen())},b(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"startCamera",value:function(){w.hasVideo&&w.video?p.default.startCamera().then(function(){var e=w.members.findIndex(function(e){return e.account==v.account});if(-1!=e){var t=w.doms[e];t?(console.log("其他【摄像头】设备自动开启成功："),p.default.startLocalStream(t),p.default.setVideoViewSize()):console.error("@@@@ 不存在的节点，忽略渲染本地流")}else console.error("不存在的成员, 无法渲染",v.account)}).catch(function(e){console.error("其他【摄像头】设备自动开启失败：",e),"NotAllowedError"==e&&S.setHasVideo(!1)}):setTimeout(function(){p.default.stopCamera().then(function(){console.log("==本地摄像头关闭成功");var e=w.members.findIndex(function(e){return e.account==v.account});if(-1!=e){var t=w.doms[e];t?p.default.stopLocalStream(t):console.error("@@@@ 不存在的节点，忽略渲染本地流")}else console.error("不存在的成员, 无法渲染",v.account)}).catch(function(e){console.error("==本地摄像头关闭失败",e)})},100)}},{key:"shareScreen",value:function(){var e=this;window.navigator.userAgent.indexOf("Chrome")&&window.chrome&&(w.hasShareScreen||(S.setHasShareScreen(!0),S.setScreenShareing4Local(!0),S.setChromeDown(!1),p.default.startChromeShareScreen().then(function(){console.log("===屏幕共享启动成功"),S.setHasShareScreen(!1),y.custom&&(y.custom.fullScreenType=1,h.default.updateChatroom(y.custom));var e=w.members.findIndex(function(e){return e.account==v.account});if(-1!=e){var t=w.doms[e];t?(console.log("当前人员加入节点：",t),p.default.startLocalStream(t),p.default.setVideoViewSize(),setTimeout(function(){var e=document.getElementById("videoShare");e.srcObject=t.childNodes[0].childNodes[0].srcObject,e.play(),S.setShareStarted(!0)},1e3)):console.error("@@@@ 不存在的节点，忽略渲染本地流")}else console.error("不存在的成员, 无法渲染",v.account)}).catch(function(t){console.error("屏幕共享启动失败",t),S.setHasShareScreen(!1),t&&62008===t.code?(S.setChromeDown(!0),S.setShareStarted(!1)):e.showWhiteboardPanel()})),p.default.changeRoleToPlayer())}},{key:"render",value:function(){var e=d.Storage.get("isTeacher"),t=this.props,o=(t.children,t.className,this.state,w.screenShareing4Local&&1!=e?"屏幕共享":"白板");return i.default.createElement("div",{className:"m-whiteboard"},i.default.createElement("div",{className:"u-tab"},i.default.createElement("div",{className:"u-tab-header u-tab-header-big"},i.default.createElement("div",{className:(0,c.default)("u-tab-item u-tab-item-big",0==w.tabIndex?"active":""),onClick:this.showWhiteboardPanel},o),1==e&&i.default.createElement("div",{className:(0,c.default)("u-tab-item u-tab-item-big",1==w.tabIndex?"active":""),onClick:this.showScreenSharePanel},"屏幕共享")),i.default.createElement("div",{className:"u-tab-body"},i.default.createElement(s.default,{visible:0==w.tabIndex}),1==e?i.default.createElement(u.default,{visible:1==w.tabIndex}):i.default.createElement(f.default,{className:"m-whiteboard-video m-whiteboard-container-cover",visible:w.screenShareing4Local}))))}}]),t}())||n;t.default=_},524:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=f(a),c=(f(o(7)),o(19)),l=o(525),s=f(o(42)),u=o(11);function f(e){return e&&e.__esModule?e:{default:e}}u.StoreChatroom.state,u.StoreChatroom,u.StoreNim.state,u.StoreNim;var d=u.StoreNetcall.state,m=(0,c.observer)(n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentDidMount",value:function(){console.log("whiteboard::componentDidMount"),s.default.setContainer(this.node)}},{key:"render",value:function(){var e=this,t=this.props.visible;return i.default.createElement("div",{className:"m-whiteboard-container "+(t?"":"hide")},i.default.createElement("div",{className:"m-whiteboard-canvas",ref:function(t){return e.node=t}}),i.default.createElement(l.WbKit,null),i.default.createElement(l.FileKit,{visible:d.hasPermission}))}}]),t}())||n;t.default=m},525:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(526);Object.defineProperty(t,"WbKit",{enumerable:!0,get:function(){return i(n).default}});var r=o(528);Object.defineProperty(t,"DrawKit",{enumerable:!0,get:function(){return i(r).default}});var a=o(529);function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"FileKit",{enumerable:!0,get:function(){return i(a).default}})},526:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=o(19),l=(d(o(7)),o(23)),s=d(o(527)),u=d(o(42)),f=o(11);function d(e){return e&&e.__esModule?e:{default:e}}var m=f.StoreNetcall.state,p=f.StoreChatroom.state,h=f.StoreWhiteBoard.state,g=(0,c.observer)(n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"setDrawModeFlag",value:function(){u.default.setDrawModeFlag()}},{key:"setDrawModeFree",value:function(){u.default.setDrawModeFree()}},{key:"undo",value:function(){u.default.undo()}},{key:"clear",value:function(){u.default.clear()}},{key:"openFileKit",value:function(){f.StoreWhiteBoard.setFileKitEnable(!0)}},{key:"resetFileKit",value:function(){f.StoreWhiteBoard.setFileKitEnable(!1),u.default.clearFile(),u.default.setDrawModeFree()}},{key:"onPageChange",value:function(e){console.log("onPageChange",e),u.default.clear(),u.default.setImage(e)}},{key:"render",value:function(){return m.hasPermission&&i.default.createElement(l.Row,{className:"m-kit m-kit-wb"},i.default.createElement("div",{className:"m-kit-wb-option"},"owner"===p.type&&i.default.createElement(l.Tooltip,{title:"激光笔"},i.default.createElement("i",{className:"u-icon iconfont icon-dot "+("flag"===h.currentDrawMode?"active":""),onClick:this.setDrawModeFlag})),i.default.createElement(l.Tooltip,null,"free"===h.currentDrawMode&&i.default.createElement(s.default,null),i.default.createElement("i",{className:"u-icon iconfont icon-pen "+("free"===h.currentDrawMode?"active":""),onClick:this.setDrawModeFree})),i.default.createElement(l.Tooltip,{title:"撤销"},i.default.createElement("i",{className:"u-icon iconfont icon-undo",onClick:this.undo})),"owner"===p.type&&i.default.createElement(l.Tooltip,{title:"清屏"},i.default.createElement("i",{className:"u-icon iconfont icon-clear",onClick:this.clear}))),"owner"===p.type&&h.currentFile&&i.default.createElement("div",{className:"m-kit-wb-pagination"},i.default.createElement(l.Tooltip,{title:"分页"},i.default.createElement(l.Pagination,{id:h.currentFile.docId,totalPage:h.currentFile.pageCount,currPage:h.currentFile.currentPage,onChange:this.onPageChange}))),"owner"===p.type&&i.default.createElement("div",{className:"m-kit-wb-file"},i.default.createElement(l.Tooltip,{title:"打开文档库",className:"m-kit-wb-file-item"},i.default.createElement("i",{className:"u-icon iconfont u-file-icon",onClick:this.openFileKit},"文档库")),h.currentFile&&i.default.createElement(l.Tooltip,{title:"停止使用文档",className:"m-kit-wb-file-item"},i.default.createElement("i",{className:"u-icon iconfont u-file-icon",onClick:this.resetFileKit},"关闭文档"))))}}]),t}())||n;t.default=g},527:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=f(a),c=o(19),l=(f(o(7)),o(23)),s=f(o(42)),u=o(11);function f(e){return e&&e.__esModule?e:{default:e}}u.StoreNetcall.state,u.StoreChatroom.state;var d=u.StoreWhiteBoard.state,m=(0,c.observer)(n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"setColor",value:function(e){s.default.setColor(e)}},{key:"render",value:function(){var e=this;return i.default.createElement("div",{className:"m-kit m-kit-color"},i.default.createElement(l.Col,{span:6},d.colorList.map(function(t,o){return i.default.createElement("i",{key:o,className:"u-icon u-icon-color "+(d.currentDrawColor===t?"active":""),style:{backgroundColor:t},onClick:function(){return e.setColor(t)}})})))}}]),t}())||n;t.default=m},528:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=u(a),c=(u(o(7)),o(19)),l=o(23),s=o(11);function u(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=s.StoreWhiteBoard,m=s.StoreWhiteBoard.state,p=(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.styleClick=function(e){d.setStyle(e)},f(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){var e=this;return i.default.createElement(l.Row,{className:"m-kit m-kit-draw flex-v"},i.default.createElement(l.Col,{span:6},i.default.createElement("i",{className:"u-icon u-icon-color"}),i.default.createElement("i",{className:"u-icon u-icon-color"}),i.default.createElement("i",{className:"u-icon u-icon-color"}),i.default.createElement("i",{className:"u-icon u-icon-color"}),i.default.createElement("i",{className:"u-icon u-icon-color"}),i.default.createElement("i",{className:"u-icon u-icon-color"})),i.default.createElement(l.Col,{span:4},m.styleList.map(function(t,o){return i.default.createElement(l.Icon,{key:o,className:"u-icon u-icon-"+t,active:t===m.style,onClick:function(){return e.styleClick(t)}})})),i.default.createElement(l.Col,{span:1},i.default.createElement("i",{className:"u-icon u-icon-fill iconfont icon-shuru-tianchong"})))}}]),t}())||n;t.default=p},529:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=f(a),c=o(19),l=(f(o(7)),o(23)),s=f(o(42)),u=o(11);function f(e){return e&&e.__esModule?e:{default:e}}var d=u.StoreWhiteBoard.state,m=(0,c.observer)(n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentWillReceiveProps",value:function(e){console.log("componentWillReceiveProps",e)}},{key:"open",value:function(){}},{key:"close",value:function(){u.StoreWhiteBoard.setFileKitEnable(!1)}},{key:"fileChange",value:function(){s.default.uploadFile()}},{key:"useFile",value:function(e){u.StoreWhiteBoard.setCurrentFile(e.docId),u.StoreWhiteBoard.setFileKitEnable(!1),s.default.setImage(1,e),s.default.setDrawModeFlag()}},{key:"deleteFile",value:function(e){Alert.open({title:"提示",msg:'<div class="u-stop-interaction"><i class="u-icon-tip"></i>确认要删除该文件吗？</div>',isHtml:!0,btns:[{label:"删除",clsName:"u-btn-smaller f-mgr-10",onClick:function(){s.default.deleteFile(e.docId),Alert.close()}},{label:"取消",clsName:"u-btn-cancle",onClick:function(){Alert.close()}}]})}},{key:"renderState",value:function(e){var t=this,o=null,n=d.serializeFileStateMap,r=d.unserializeFileStateText;return e.state-n.TRANSCOMPLETE==0&&(o=i.default.createElement(l.Col,{span:2,className:"m-kit-file-item-option"},i.default.createElement(l.Button,{className:"u-btn-smaller",onClick:function(){return t.useFile(e)}},"使用"),i.default.createElement(l.Button,{className:"u-btn-smaller",onClick:function(){return t.deleteFile(e)}},"删除"))),e.state-n.TRANSTIMEOUT!=0&&e.state-n.TRANSFAIL!=0&&e.state-n.UPLOADFAIL!=0||(o=i.default.createElement(l.Col,{span:2,className:"m-kit-file-item-option"},i.default.createElement("span",null,r[e.state]),i.default.createElement("span",{className:"m-kit-file-cancel",onClick:function(){return t.deleteFile(e)}},"删除"))),e.state-n.TRANSING!=0&&e.state-n.UPLOADING!=0&&e.state-n.PRETRANS!=0||(o=i.default.createElement(l.Col,{span:2,className:"m-kit-file-item-option"},i.default.createElement("span",null,r[e.state]),i.default.createElement("span",null,"(",e.percent||0,"%)"),i.default.createElement("span",{className:"m-kit-file-cancel",onClick:function(){return t.deleteFile(e)}},"取消"))),o}},{key:"render",value:function(){var e=this;return console.log("render kit.file"),d.fileKitEnable&&i.default.createElement(l.Row,{className:"m-kit m-kit-file"},i.default.createElement(l.Col,{span:2,className:"m-kit-file-header"},i.default.createElement("span",null,"文档库"),i.default.createElement("i",{className:"u-icon iconfont icon-close",onClick:this.close}),d.showFileTip&&i.default.createElement(l.Tip,{message:"关闭文档库窗口，不影响上传",time:5})),i.default.createElement(l.Col,{span:2,className:"m-kit-file-body "+(0===d.fileList.length?"empty":"")},d.fileList.map(function(t,o){return i.default.createElement("div",{key:o,className:"m-kit-file-item"},i.default.createElement(l.Row,{className:"m-kit-file-content"},i.default.createElement(l.Col,{span:1,className:"m-kit-file-item-preview "+d.serializefileTypeMap[t.type]}),i.default.createElement(l.Col,{span:3,className:"m-kit-file-item-desc"},t.name),e.renderState(t)),i.default.createElement(l.Progress,{percent:t.percent,visible:!0}))})),i.default.createElement(l.Col,{span:2,className:"m-kit-file-footer"},d.showFileTip&&i.default.createElement(l.Tip,{message:"上传文档不超过100页",time:5,onClose:function(){console.log("上传文档不超过100页 关闭"),u.StoreWhiteBoard.setFileTip(!1)}}),i.default.createElement(l.Input,{domRef:function(e){e&&u.StoreWhiteBoard.setFileInput(e)},multiple:!0,onChange:this.fileChange,type:"file",accept:".pdf,.ppt,.pptx",className:"m-kit-file-select"}),"上传文档(PDF/PPT/PPTX)"))}}]),t}())||n;t.default=m},530:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=f(a),c=f(o(7)),l=o(19),s=o(11),u=f(o(27));function f(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=s.StoreNim.state,p=(s.StoreNim,s.StoreChatroom.state,s.StoreChatroom,s.StoreNetcall.state),h=s.StoreNetcall,g=(0,l.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=d(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={isFullScreen:!1},d(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){var e=this.props.visible,t="";return t=window.navigator.userAgent.indexOf("Chrome")&&window.chrome?p.chromeDown?i.default.createElement("div",{className:"video-share-container"},i.default.createElement("p",{className:"share-text"},"检测到您还没有安装屏幕共享插件，请先下载插件，安装完成之后",i.default.createElement("a",{href:"javascript:;",onClick:this.reload},"刷新"),"页面，体验屏幕共享功能。"),i.default.createElement("a",{className:"share-plug",href:"https://app.yunxin.163.com/webdemo/3rd/chrome/yunxin-Web-Screensharing.crx"},"下载Chrome插件"),i.default.createElement("p",{className:"share-text2"},"提示：下载完插件，请先参考",i.default.createElement("a",{href:"http://dev.netease.im/docs/product/%E9%80%9A%E7%94%A8/Demo%E6%BA%90%E7%A0%81%E5%AF%BC%E8%AF%BB/%E5%9C%A8%E7%BA%BF%E6%95%99%E8%82%B2Demo/Web%E6%BA%90%E7%A0%81%E5%AF%BC%E8%AF%BB?#Chrome%E5%B1%8F%E5%B9%95%E5%85%B1%E4%BA%AB%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85",target:"_blank"},"Chrome屏幕共享插件安装教程"),"，再安装插件")):i.default.createElement("div",{className:"video-share-container"},i.default.createElement("video",{id:"videoShare",className:(0,c.default)("video-share",this.state.isFullScreen?"fullscreen-teacher":""),width:"100%"}),i.default.createElement("div",{className:(0,c.default)(this.state.isFullScreen?"video-fullscreen-box":"video-fullscreen-box-no")},i.default.createElement("span",{className:(0,c.default)(this.state.isFullScreen?"exit-fullscreen":"video-fullscreen"),onClick:this.fullScreen.bind(this,"videoShare")})),i.default.createElement("div",{className:"change-video u-btn u-btn u-btn-smaller",onClick:this.shareScreen},"切换")):i.default.createElement("div",{className:"share-text"},"该浏览器下暂不支持屏幕共享，请在Chrome浏览器下打开Web端教育demo，使用屏幕共享功能。若未下载Chrome浏览器，请先",i.default.createElement("a",{href:"javascript:;",onClick:this.downChrome},"下载Chrome浏览器"),"。"),i.default.createElement("div",{className:(0,c.default)("m-whiteboard-container",e?"":"hide")},t)}},{key:"reload",value:function(){window.location.reload()}},{key:"downChrome",value:function(){window.open("https://www.baidu.com/s?wd=chrome")}},{key:"fullScreen",value:function(e){this.setState({isFullScreen:!this.state.isFullScreen})}},{key:"shareScreen",value:function(){var e=this;window.navigator.userAgent.indexOf("Chrome")&&window.chrome&&(p.hasShareScreen||(h.setHasShareScreen(!0),u.default.startChromeShareScreen().then(function(){console.log("=== 屏幕共享启动成功"),h.setHasShareScreen(!1);var e=p.members.findIndex(function(e){return e.account==m.account});if(-1!=e){var t=p.doms[e];t?(console.log("当前人员加入节点：",t),u.default.startLocalStream(t),u.default.setVideoViewSize(),setTimeout(function(){var e=document.getElementById("videoShare");e.srcObject=t.childNodes[0].childNodes[0].srcObject,e.play(),h.setShareStarted(!0)},1e3)):console.error("@@@@ 不存在的节点，忽略渲染本地流")}else console.error("不存在的成员, 无法渲染",m.account)}).catch(function(t){h.setHasShareScreen(!1),console.error("屏幕共享启动失败",t),t&&62008===t.code?(h.setChromeDown(!0),h.setShareStarted(!1)):e.showWhiteboardPanel()})),u.default.changeRoleToPlayer())}}]),t}())||n;t.default=g},531:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=d(o(7)),l=o(19),s=o(11),u=o(13),f=(d(o(26)),d(o(25)),d(o(27)));d(o(144));function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}s.StoreNim.state,s.StoreNim,s.StoreChatroom.state,s.StoreChatroom;var p=s.StoreNetcall.state,h=s.StoreNetcall,g=(0,l.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={isFullScreen:!1},n.exitFullScreen=function(e){h.setScreenShareing4Local(!1);var t=u.Storage.get("teacherAccount"),o=h.findMember({account:t});console.log("### 缩小",o,p.doms[o],t),f.default.startRemoteStream(t,p.doms[o]),f.default.setVideoViewRemoteSize(t),document.querySelectorAll("video").forEach(function(e){e.play()})},m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){var e=this.props,t=e.className,o=e.visible,n="";return p.screenShareing4Local&&(n=i.default.createElement("div",{className:(0,c.default)(this.state.isFullScreen?"video-fullscreen-box":"video-fullscreen-box-no")},i.default.createElement("div",{className:"exit-fullscreen",onClick:this.exitFullScreen}),i.default.createElement("div",{className:"video-fullscreen",onClick:this.toggleFullscreen.bind(this)}))),i.default.createElement("div",{className:(0,c.default)("m-fullscreen-box",o?"":"hide")},i.default.createElement("div",{id:"m-whiteboard-fullscreen",className:(0,c.default)("m-whiteboard-container",t,o?"":"hide",this.state.isFullScreen?"m-whiteboard-video-fullscreen":"m-whiteboard-video")}),n)}},{key:"toggleFullscreen",value:function(e){(e=document.querySelector("#m-whiteboard-fullscreen video"))&&(e.play(),this.setState({isFullScreen:!this.state.isFullScreen}))}}]),t}())||n;t.default=g},532:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=function(e){return e&&e.__esModule?e:{default:e}}(r),i=o(23);var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=e.body,o=e.isHtml;return a.default.createElement("div",{className:"u-alert-wrapper"},a.default.createElement(i.Mask,{visible:!0}),a.default.createElement("section",{className:"u-alert"},t&&a.default.createElement("div",{className:"u-alert-body"},a.default.createElement("i",{className:"u-loading"}),o?renderHTML(t):t)))}}]),t}();t.default=c},549:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=c(r),i=c(o(107));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.state={optionList:[{roomname:"1234",roomid:"1234"},{roomname:"1235",roomid:"1235"},{roomname:"1236",roomid:"1236"}],value:"",optionValue:""},o.onChange=o.onChange.bind(o),o.onSelectChange=o.onSelectChange.bind(o),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){this.getOptions()}},{key:"onChange",value:function(e){console.log(e.target.value),this.setState({value:e.target.value}),this.props.setRoomId(e.target.value)}},{key:"onSelectChange",value:function(e){this.setState({value:e.target.value}),this.props.setRoomId(e.target.value)}},{key:"getOptions",value:function(){var e=this;i.default.get("http://125.124.143.31:8888/ssm/getroom").then(function(t){console.log(t.data),console.log("发送请求成功"),e.setState({optionList:t.data}),console.log("获取房间号",t.data)}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this.props.placeholder;return a.default.createElement("div",null,a.default.createElement("input",{style:{position:"absolute",width:"105px",height:"25px",border:"1px solid #00CED1"},onChange:this.onSelectChange,value:this.state.value,placeholder:e}),a.default.createElement("select",{style:{width:"120px",height:"25px"},defaultValue:"",onChange:this.onSelectChange,value:this.state.value},a.default.createElement("option",{value:"",disabled:!0,style:{display:"none"}}),this.state.optionList.map(function(e){return a.default.createElement("option",{key:e.roomid,value:e.roomid},""+e.roomname)})))}}]),t}();t.default=l},550:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(o(199));function c(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,o){return function n(r,a){try{var i=t[r](a),c=i.value}catch(e){return void o(e)}if(!i.done)return Promise.resolve(c).then(function(e){n("next",e)},function(e){n("throw",e)});e(c)}("next")})}}var l=function(){var e=c(regeneratorRuntime.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.2;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,o){return setTimeout(e,1e3*t)}));case 1:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),s=(r=n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,null,[{key:"createInstance",value:function(){var e=c(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._instance){e.next=2;break}return e.abrupt("return",this._instance);case 2:return console.log("now",Date.now()),e.next=5,l();case 5:return console.log("now",Date.now()),this._instance=i.default.newInstance(t),e.abrupt("return",this._instance);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"show",value:function(){var e=c(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._instance){e.next=4;break}return e.next=3,this.createInstance(t);case 3:this._instance=e.sent;case 4:return e.abrupt("return",this._instance.show(t));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"hide",value:function(){return this._instance&&this._instance.hide()}},{key:"destory",value:function(){this._instance&&this._instance.destory(),this._instance=null}}]),e}(),n._instance=null,r);t.default=s},551:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ToastCtrl=t.Toast=void 0;var n=a(o(219)),r=a(o(552));function a(e){return e&&e.__esModule?e:{default:e}}t.Toast=n.default,t.ToastCtrl=r.default},552:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(o(219));var c=(r=n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,null,[{key:"createInstance",value:function(e){return this._instance=this._instance||i.default.newInstance(e),this._instance}},{key:"show",value:function(e){var t=this,o=e.time,n=void 0===o?3:o;console.log("Toast show inOptions",e),this._instance||this.createInstance(e),this._instance.show(e),n&&setTimeout(function(){t.hide()},1e3*n)}},{key:"hide",value:function(){return this._instance.hide()}},{key:"destory",value:function(){this._instance.destory(),this._instance=null}}]),e}(),n._instance=null,r);t.default=c},553:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(o(198));window.Alert=n.default,t.default={show:function(){n.default.open({msg:'<i className="u-loading" ></i>请稍后...',isHtml:!0,confirm:!1})},hide:function(){n.default.close()}}},554:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=[].concat(Array.prototype.slice.call(arguments));return n._pipe(1===e.length?e[0]:e)};var n={pipe:function(){var e=[].concat(Array.prototype.slice.call(arguments));return this._pipe(1===e.length?e[0]:e)},_pipe:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments[1],n=t.shift();return(o&&o.constructor===Promise?o:Promise.resolve(o)).then(function(){return 0===t.length?e._pipeLast(n,o):e._pipeLast(n,o).then(function(o){return console.log("当前结果",o),e._pipe(t,o)})})},_pipeLast:function(e,t){if(!e||e.constructor!==Function&&e.constructor!==Promise)return Promise.resolve(e);if(e.constructor===Promise)return e;if(e.constructor===Function){var o=e(t);return o&&o.constructor===Promise?o:Promise.resolve(o)}return Promise.resolve(e)}}},555:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a){var i=t||{},c=o||document.body,l=document.createElement("div");return c.appendChild(l),r.default.render(n.default.createElement(e,i),l)};var n=a(o(1)),r=(a(o(7)),a(o(70)));function a(e){return e&&e.__esModule?e:{default:e}}},556:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();t.default=function(e){var t,o;return o=t=function(t){function o(){var e,t,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=s(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(a))),t=n,n.state={Component:o.Component},s(n,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(o,t),n(o,[{key:"componentWillMount",value:function(){var t=this;this.state.Component||e().then(function(e){o.Component=e,t.setState({Component:e})})}},{key:"componentWillUpdate",value:function(e){}},{key:"render",value:function(){var e=this.state.Component;return e?(c.default.done(),a.default.createElement(e,this.props)):a.default.createElement(i.Loading,{body:"加载中，请稍等..."})}}]),o}(r.Component),t.Component=null,o};var r=o(1),a=l(r),i=o(105),c=l(o(220));function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}},557:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.success,o=e.fail;(function(){if(!window.WebRTC||!window.WhiteBoard||!WhiteBoard.checkCompatibility())return console.log("检查reject"),Promise.reject();return WebRTC.checkCompatibility().then(function(e){console.log("checkCompatibility",e);var t=+e.version.match(/\d+/)[0],o="Chrome"===e.prefix&&t>=58||"Firefox"===e.prefix&&t>=58;return o?Promise.resolve():(console.log("检查reject"),Promise.reject())})})().then(function(){t&&t()}).catch(function(){Alert.open({className:"u-alert-1",title:"提示",msg:'<div class="u-check-compatibility"><i class="u-icon-tip"></i><div class="tip-content"><div class="c1">当前浏览器不支持WebRTC，无法正常使用白板互动功能。</div><div class="c2">白板功能中的音频功能需要WebRTC的支持，请使用最新版Chrome浏览器。</div><div class="c3">下载最新Chrome浏览器，重新打开网页即可。</div></div></div>',isHtml:!0,btns:[{label:"下载最新Chrome",clsName:"u-btn-longer f-h-26 f-mgr-10",onClick:function(){window.open("https://www.baidu.com/s?wd=chrome")}},{label:"仍要体验",clsName:"u-btn-cancle",onClick:function(){Alert.close(),o&&o()}}],close:function(){console.log("【兼容浏览器】 --\x3e X"),Alert.close()}})})},window.test=function(){Alert.open({className:"u-alert-1",title:"提示",msg:'<div class="u-check-compatibility"><i class="u-icon-tip"></i><div class="tip-content"><div class="c1">当前浏览器不支持WebRTC，无法正常使用白板互动功能。</div><div class="c2">白板功能中的音频功能需要WebRTC的支持，请使用最新版Chrome浏览器。</div><div class="c3">下载最新Chrome浏览器，重新打开网页即可。</div></div>',isHtml:!0,btns:[{label:"下载最新Chrome",clsName:"u-btn-longer f-h-26 f-mgr-10",onClick:function(){Alert.close(),window.open("https://www.baidu.com/s?wd=chrome")}},{label:"仍要体验",clsName:"u-btn-cancle",onClick:function(){Alert.close()}}],close:function(){console.log("【兼容浏览器】 --\x3e X"),Alert.close()}})}},558:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){function t(e,t){return e<<t|e>>>32-t}function o(e,t){var o,n,r,a,i;return r=2147483648&e,a=2147483648&t,i=(1073741823&e)+(1073741823&t),(o=1073741824&e)&(n=1073741824&t)?2147483648^i^r^a:o|n?1073741824&i?3221225472^i^r^a:1073741824^i^r^a:i^r^a}function n(e,n,r,a,i,c,l){return o(t(e=o(e,o(o(function(e,t,o){return e&t|~e&o}(n,r,a),i),l)),c),n)}function r(e,n,r,a,i,c,l){return o(t(e=o(e,o(o(function(e,t,o){return e&o|t&~o}(n,r,a),i),l)),c),n)}function a(e,n,r,a,i,c,l){return o(t(e=o(e,o(o(function(e,t,o){return e^t^o}(n,r,a),i),l)),c),n)}function i(e,n,r,a,i,c,l){return o(t(e=o(e,o(o(function(e,t,o){return t^(e|~o)}(n,r,a),i),l)),c),n)}function c(e){var t,o="",n="";for(t=0;t<=3;t++)o+=(n="0"+(e>>>8*t&255).toString(16)).substr(n.length-2,2);return o}var l,s,u,f,d,m,p,h,g,b=Array();for(b=function(e){for(var t,o=e.length,n=o+8,r=16*((n-n%64)/64+1),a=Array(r-1),i=0,c=0;c<o;)i=c%4*8,a[t=(c-c%4)/4]=a[t]|e.charCodeAt(c)<<i,c++;return i=c%4*8,a[t=(c-c%4)/4]=a[t]|128<<i,a[r-2]=o<<3,a[r-1]=o>>>29,a}(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",o=0;o<e.length;o++){var n=e.charCodeAt(o);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}(e)),m=1732584193,p=4023233417,h=2562383102,g=271733878,l=0;l<b.length;l+=16)s=m,u=p,f=h,d=g,p=i(p=i(p=i(p=i(p=a(p=a(p=a(p=a(p=r(p=r(p=r(p=r(p=n(p=n(p=n(p=n(p,h=n(h,g=n(g,m=n(m,p,h,g,b[l+0],7,3614090360),p,h,b[l+1],12,3905402710),m,p,b[l+2],17,606105819),g,m,b[l+3],22,3250441966),h=n(h,g=n(g,m=n(m,p,h,g,b[l+4],7,4118548399),p,h,b[l+5],12,1200080426),m,p,b[l+6],17,2821735955),g,m,b[l+7],22,4249261313),h=n(h,g=n(g,m=n(m,p,h,g,b[l+8],7,1770035416),p,h,b[l+9],12,2336552879),m,p,b[l+10],17,4294925233),g,m,b[l+11],22,2304563134),h=n(h,g=n(g,m=n(m,p,h,g,b[l+12],7,1804603682),p,h,b[l+13],12,4254626195),m,p,b[l+14],17,2792965006),g,m,b[l+15],22,1236535329),h=r(h,g=r(g,m=r(m,p,h,g,b[l+1],5,4129170786),p,h,b[l+6],9,3225465664),m,p,b[l+11],14,643717713),g,m,b[l+0],20,3921069994),h=r(h,g=r(g,m=r(m,p,h,g,b[l+5],5,3593408605),p,h,b[l+10],9,38016083),m,p,b[l+15],14,3634488961),g,m,b[l+4],20,3889429448),h=r(h,g=r(g,m=r(m,p,h,g,b[l+9],5,568446438),p,h,b[l+14],9,3275163606),m,p,b[l+3],14,4107603335),g,m,b[l+8],20,1163531501),h=r(h,g=r(g,m=r(m,p,h,g,b[l+13],5,2850285829),p,h,b[l+2],9,4243563512),m,p,b[l+7],14,1735328473),g,m,b[l+12],20,2368359562),h=a(h,g=a(g,m=a(m,p,h,g,b[l+5],4,4294588738),p,h,b[l+8],11,2272392833),m,p,b[l+11],16,1839030562),g,m,b[l+14],23,4259657740),h=a(h,g=a(g,m=a(m,p,h,g,b[l+1],4,2763975236),p,h,b[l+4],11,1272893353),m,p,b[l+7],16,4139469664),g,m,b[l+10],23,3200236656),h=a(h,g=a(g,m=a(m,p,h,g,b[l+13],4,681279174),p,h,b[l+0],11,3936430074),m,p,b[l+3],16,3572445317),g,m,b[l+6],23,76029189),h=a(h,g=a(g,m=a(m,p,h,g,b[l+9],4,3654602809),p,h,b[l+12],11,3873151461),m,p,b[l+15],16,530742520),g,m,b[l+2],23,3299628645),h=i(h,g=i(g,m=i(m,p,h,g,b[l+0],6,4096336452),p,h,b[l+7],10,1126891415),m,p,b[l+14],15,2878612391),g,m,b[l+5],21,4237533241),h=i(h,g=i(g,m=i(m,p,h,g,b[l+12],6,1700485571),p,h,b[l+3],10,2399980690),m,p,b[l+10],15,4293915773),g,m,b[l+1],21,2240044497),h=i(h,g=i(g,m=i(m,p,h,g,b[l+8],6,1873313359),p,h,b[l+15],10,4264355552),m,p,b[l+6],15,2734768916),g,m,b[l+13],21,1309151649),h=i(h,g=i(g,m=i(m,p,h,g,b[l+4],6,4149444226),p,h,b[l+11],10,3174756917),m,p,b[l+2],15,718787259),g,m,b[l+9],21,3951481745),m=o(m,s),p=o(p,u),h=o(h,f),g=o(g,d);return(c(m)+c(p)+c(h)+c(g)).toLowerCase()}},559:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){var n=null,r=null;return function(){var a=+new Date,i=this,c=arguments;r||(r=a),o&&o<a-r?(e.apply(i,c),r=a,clearTimeout(n)):(clearTimeout(n),n=setTimeout(function(){e.apply(i,c),r=null},t))}}},560:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=h(a),c=o(19),l=h(o(107)),s=o(145),u=o(23),f=o(13),d=o(11),m=h(o(26)),p=h(o(25));o(562);function h(e){return e&&e.__esModule?e:{default:e}}var g=d.StoreNim.state,b=(d.StoreNim,d.StoreChatroom.state),v=(d.StoreChatroom,d.StoreNetcall),y=(d.StoreNetcall.state,(0,c.observer)(n=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.state={roomName:"",roomId:"",netDetectStatus:"",baseImfo:"",netDetectResult:null,netDetectStyle:{display:"none"},webrtcInstance:null,showRoomNameTip:!1,showRoomIdTip:!1,roomNameErrorMsg:"",roomIdErrorMsg:"",canCreate:!0,canJoin:!0,createLoading:!1,joinLoading:!1},o.showNetStatus=function(e){var t="";t=o.state.netDetectResult&&o.state.netDetectResult.upload_network_status?"本地IP地址："+o.state.netDetectResult.user_ip+"\n丢包率："+o.state.netDetectResult.loss_rate+"\n带宽："+o.state.netDetectResult.upload_network_status[0].up_bwe+"kbps\n延迟："+o.state.netDetectResult.upload_network_status[0].up_rtt+"ms\n帧率："+o.state.netDetectResult.upload_network_status[0].up_framerate+"\n分辨率："+o.state.netDetectResult.upload_network_status[0].up_resolution:o.state.netDetectStatus,o.setState({baseImfo:t,netDetectStyle:{display:"block"}})},o.hideNetStatus=function(e){o.setState({netDetectStyle:{display:"none"}})},o.changeRoomName=function(e){if("网络状况: 检测中..."!=o.state.netDetectStatus){var t=e.target.value;f.Valid.isBlank(t)?o.setState({roomName:"",canCreate:!1}):o.setState({roomName:t.trim(),canCreate:!0})}else alert("正在网络检测，请稍后创建房间")},o.changeRoomId=function(e){if("网络状况: 检测中..."!=o.state.netDetectStatus){var t=e.target.value;f.Valid.isBlank(t)?o.setState({roomId:"",canJoin:!1}):o.setState({roomId:t.trim(),canJoin:!0})}else alert("正在网络检测，请稍后加入房间")},o.createRoom=function(e){if(console.log("submit createRoom"),o.state.canCreate&&!o.state.createLoading)if(f.Valid.isBlank(o.state.roomName))o.setState({showRoomNameTip:!0,roomNameErrorMsg:"房间名称不能为空"});else{o.setState({showRoomNameTip:!1,roomNameErrorMsg:"",createLoading:!0});var t=o;p.default.create(o.state.roomName).then(function(e){console.log("创建聊天室房间成功",e),t.addRoom(e),console.log("发送请求成功"),f.Storage.set("teacherAccount",g.account),p.default.login(e).then(function(){console.log("加入房间成功"),f.Storage.set("roomId",e),f.Storage.set("isTeacher",1),f.Storage.set("hasPermission",!0),o.preHandleRedirect()}).catch(function(e){console.error("加入房间失败",e),e||(e="加入房间失败"),o.setState({showRoomNameTip:!0,roomNameErrorMsg:e,createLoading:!1})})}).catch(function(e){console.error("创建房间失败",e),"聊天室已关闭"==e&&(e="房间不存在"),o.setState({showRoomNameTip:!0,roomNameErrorMsg:e,createLoading:!1})})}else console.log("不可创建或正在创建中...")},o.joinRoom=function(e){console.log("submit joinRoom"),o.state.canJoin&&!o.state.joinLoading?(o.setState({showRoomIdTip:!1,roomIdErrorMsg:"",joinLoading:!0}),p.default.login(o.state.roomId).then(function(){console.log("加入房间成功"),f.Storage.set("roomId",o.state.roomId),f.Storage.set("isTeacher",0),o.preHandleRedirect()}).catch(function(e){console.error("加入房间失败",e),"聊天室已关闭"==e&&(e="房间不存在"),e||(e="加入房间失败"),o.setState({showRoomIdTip:!0,roomIdErrorMsg:e,joinLoading:!1})})):console.log("不可加入或正在加入中...")},o.setRoomId=o.setRoomId.bind(o),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentDidMount",value:function(){(0,f.CheckBroswer)({success:this.autoLogin.bind(this)}),this.startNetDetect()}},{key:"startNetDetect",value:function(){var e=this;if(!this.state.netDetectResult&&""===this.state.netDetectStatus){this.setState({netDetectStatus:"网络状况: 检测中..."}),console.log("开始网络检测");var t=window.WebRTC.getInstance({debug:!0,nim:g.nim,chromeId:"gapafbpmfemleaplicdhhcikajbogpkf"});t&&t.detectNetworkStatus?t.detectNetworkStatus({detectTime:10}).then(function(o){var n="网络状况: 网络状况检测失败!";if(o){if(console.log("网络探测完成: ",JSON.stringify(o,null," ")),!e.state||"网络状况: 检测中..."!=e.state.netDetectStatus)return;e.setState({netDetectResult:o}),t.destroy(),t=null,n=o.upload_network_status[0].network_status}e.setState({netDetectStatus:n})}).catch(function(t){console.log("网络探测出现错误: ",t),e.state&&"网络状况: 检测中..."==e.state.netDetectStatus&&e.setState({netDetectStatus:"网络状况: 网络状况检测失败!"})}):this.setState({netDetectStatus:"网络状况: 网络状况非常好，音视频通话均流畅"})}}},{key:"autoLogin",value:function(){var e=this;if(g.account)this.autoLoginChatroom();else{console.log("home:开始自动登录nim过程...");var t=f.Storage.get("account"),o=f.Storage.get("token");if(!t||!o)return console.error("home:自动登录nim:缺少account或token"),void f.Page.to("login");m.default.login(t,o).then(function(){console.log("home:自动登录nim成功"),e.autoLoginChatroom()}).catch(function(e){console.error("home:自动登录nim失败"),f.Page.to("login",e)})}}},{key:"autoLoginChatroom",value:function(){var e=this;if(b.currChatroom)return console.log("home:已登录，自动切换到main"),void f.Page.to("main");console.log("home:开始自动登录chatroom过程...");var t=f.Storage.get("roomId");if(!t)return console.warn("home:自动登录chatroom失败：缺少roomid，首次登陆请忽略！"),void this.roomIdInput.focus();this.setState({showRoomIdTip:!1,roomIdErrorMsg:"",joinLoading:!0}),p.default.login(t).then(function(){console.log("home:自动登录chatroom成功"),e.preHandleRedirect()}).catch(function(t){console.error("home:自动登录chatroom失败"),e.setState({showRoomIdTip:!0,roomIdErrorMsg:t,joinLoading:!1}),e.roomIdInput.focus()})}},{key:"preHandleRedirect",value:function(){console.log("检测当前机器的可用设备...."),WebRTC.checkCompatibility().then(function(e){var t=e.Camera,o=e.Microphone;console.log("--- 设备状态",e),v.setHasAudio(o),v.setHasVideo(t)}).catch(function(e){console.error("获取当前机器可用设备时异常: ",e),v.setHasAudio(!1),v.setHasVideo(!1)}),f.Page.to("main")}},{key:"addRoom",value:function(e){var t={roomname:this.state.roomName,roomid:e};l.default.get("http://125.124.143.31:8888/ssm/addroom",{params:t}).then(function(e){console.log(e.data),console.log("发送请求成功")}).catch(function(e){console.log(e)})}},{key:"setRoomId",value:function(e){this.setState({roomId:e})}},{key:"render",value:function(){var e=this,t=this.state;return i.default.createElement("div",null,i.default.createElement(s.Header,{isHome:!0}),i.default.createElement("div",{className:"m-home"},i.default.createElement("div",{className:"net-detect"},i.default.createElement("div",{className:"layer1"},i.default.createElement("div",{className:"wifi"})),i.default.createElement("div",{className:"describe"}," ",t.netDetectStatus," "),i.default.createElement("div",{className:"u-tips-mark",onMouseOver:this.showNetStatus,onMouseOut:this.hideNetStatus},i.default.createElement("div",{className:"tips-mark"}))),i.default.createElement("div",{className:"detectResult-tips",style:t.netDetectStyle},i.default.createElement(u.TextArea,{id:"test",className:"base-imfo",value:t.baseImfo})),i.default.createElement("div",{className:"split-line"}),i.default.createElement("div",{className:"part part-1"},i.default.createElement("div",{className:"icon icon-createroom"}),i.default.createElement("div",{className:"item item-1 f-tac"},i.default.createElement(u.Input,{placeholder:"请输入房间名称",value:t.roomName,onChange:this.changeRoomName,domRef:function(t){e.roomNameInput=t}})),i.default.createElement("div",{className:"errortip ",hidden:!t.showRoomNameTip},t.roomNameErrorMsg),i.default.createElement("div",{className:"item item-2  f-tac"},i.default.createElement(u.Button,{className:"u-btn-longer",onClick:this.createRoom,loading:t.createLoading,disabled:!t.canCreate},"创建房间"))),i.default.createElement("div",{className:"part part-2"},i.default.createElement("div",{className:"icon icon-joinroom"}),i.default.createElement("div",{className:"item item-1 f-tac"},i.default.createElement(u.SelectCom,{placeholder:"请输入房间ID号码",setRoomId:this.setRoomId})),i.default.createElement("div",{className:"errortip ",hidden:!t.showRoomIdTip},t.roomIdErrorMsg),i.default.createElement("div",{className:"item item-2  f-tac"},i.default.createElement(u.Button,{className:"u-btn-longer",onClick:this.joinRoom,loading:t.joinLoading,disabled:!t.canJoin},"加入房间")),i.default.createElement("div",{className:"tip"},"注：房间ID为创建房间后 生成的9位数字"))))}}]),t}())||n);t.default=y},561:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=(d(o(7)),d(o(107)),o(19)),l=o(11),s=d(o(26)),u=d(o(25)),f=(d(o(27)),d(o(42)),o(13));function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=l.StoreNim.state,h=(l.StoreNim,l.StoreChatroom.state),g=(l.StoreChatroom,l.StoreNetcall.state,l.StoreNetcall,(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.logout=function(){console.log("退出im...."),f.Alert.open({title:"操作确认",msg:'<div class="u-logoutim"><i class="u-icon-tip"></i> 确认要退出在线教育Demo？</div>',isHtml:!0,btns:[{label:"退出",clsName:"u-btn-smaller f-mgr-10 ",onClick:function(){console.log("【退出IM弹窗】 --\x3e 确认"),n.doLogoutIM()}},{label:"取消",clsName:"u-btn-cancle",onClick:function(){console.log("【退出IM弹窗】 --\x3e 取消"),f.Alert.close()}}]})},n.doLogoutIM=function(){f.Alert.close(),s.default.logout()},n.doLogoutChatroom=function(){u.default.logout(h.currChatroomId)},n.doClose4Teacher=function(){console.log("老师：结束教学..."),f.Alert.close(),u.default.close(h.currChatroomId).then(function(){console.log("关闭聊天室成功，继续退出流程"),n.doLogoutChatroom()}).catch(function(e){console.log("关闭聊天室失败: ",e)})},n.doClose4Student=function(){console.log("学生：退出房间..."),f.Alert.close(),n.doLogoutChatroom()},n.doCancle=function(){console.log("【关闭确认弹窗】 -> 取消..."),f.Alert.close()},n.closeChatroom=function(){var e="owner"==h.type,t='<div class="u-exitroom">'+(e?'<i class="u-icon-tip"></i> 确认要结束教学? ':'<i class="u-icon-tip"></i> 确认要退出房间?')+"</div>",o=[{clsName:"u-btn-smaller f-mgr-10 f-w-70"},{label:"取消",clsName:"u-btn-cancle",onClick:function(){n.doCancle()}}];e?(o[0].label="结束教学",o[0].onClick=function(){n.doClose4Teacher()}):(o[0].label="退出房间",o[0].onClick=function(){n.doClose4Student()}),f.Alert.open({title:"提示",msg:t,isHtml:!0,btns:o})},m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){var e=this.props.isHome;return i.default.createElement("div",{className:"m-header"},i.default.createElement("div",{className:"logo"},"在线教育DEMO",h.type?"owner"==h.type?"-教师端":"-学生端":""),i.default.createElement("div",{className:"opt"},p.account,i.default.createElement("div",{className:"opt-inner"},e?i.default.createElement("a",{href:"javascript:void(0);",className:"logout",onClick:this.logout},"退出"):i.default.createElement("a",{href:"javascript:void(0);",className:"close",onClick:this.closeChatroom},i.default.createElement("span",null,"关闭")))))}}]),t}())||n);t.default=g},595:function(e,t){},596:function(e,t){},642:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=o(19),l=o(23),s=o(13),u=o(11),f=d(o(26));function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}u.StoreNim.state,u.StoreNim;var p=(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={account:"",pwd:"",errorTip:"",showErrorTip:!1,canLogin:!1,hasAccount:!1,hasPwd:!1,loginLoading:!1},n.changeAccount=function(e){var t=e.target.value;s.Valid.isBlank(t)?n.setState({hasAccount:!1,account:"",canLogin:!1}):n.setState(function(e,o){return{hasAccount:!0,account:t.trim(),canLogin:e.hasPwd}})},n.changePwd=function(e){var t=e.target.value;s.Valid.isBlank(t)?n.setState({hasPwd:!1,pwd:"",canLogin:!1}):n.setState(function(e,o){return{hasPwd:!0,pwd:t.trim(),canLogin:e.hasAccount}})},n.submit=function(){n.state.canLogin&&!n.state.loginLoading?s.Valid.isBlank(n.state.account)?n.setState({showErrorTip:!0,errorTip:"账号不能为空"}):s.Valid.isBlank(n.state.pwd)?n.setState({showErrorTip:!0,errorTip:"密码不能为空"}):(n.setState({showErrorTip:!1,errorTip:"",loginLoading:!0}),n.requestLogin({account:n.state.account,pwd:n.state.pwd})):console.log("不可点击登录或正在登录中...")},m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentDidMount",value:function(){(0,s.CheckBroswer)({success:this.autoLogin.bind(this)})}},{key:"autoLogin",value:function(){console.log("login:开始自动登录nim过程...");var e=function(e){for(var t=e+"=",o=decodeURIComponent(document.cookie).split(";"),n=0;n<o.length;n++){for(var r=o[n];" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return""}("studentId"),t="pwd"+e.slice(-6),o=(0,s.MD5)(t);console.log("用户登录中",e,t,o);var n=this;e&&o||(console.warn("login:自动登录nim:缺少account或token，首次登陆请忽略！"),n.requestRegist({username:e,nickname:"",password:t})),f.default.login(e,o).then(function(){console.log("login:自动登录nim成功"),s.Storage.set("account",e),s.Storage.set("token",o),s.Page.to("home")}).catch(function(o){console.error("login:自动登录nim失败,执行注册"),n.requestRegist({username:e,nickname:"uid"+e.slice(-6),password:t})})}},{key:"requestRegist",value:function(e){var t=this;f.default.regist(e).then(function(){console.log("注册成功"),t.autoLogin()}).catch(function(e){console.error("注册失败",e)})}},{key:"regist",value:function(){console.log("跳转到注册页..."),s.Page.to("regist")}},{key:"requestLogin",value:function(e){var t=this,o=e.account,n=(0,s.MD5)(e.pwd);f.default.login(o,n).then(function(){console.log("登录成功"),s.Storage.set("account",e.account),s.Storage.set("token",n),s.Page.to("home")}).catch(function(e){console.error("登录失败",e),t.accountInput.focus(),t.setState({showErrorTip:!0,errorTip:e,loginLoading:!1})})}},{key:"render",value:function(){var e=this,t=this.state;return i.default.createElement("div",{className:"m-login"},i.default.createElement("div",{className:"form-part"},i.default.createElement("div",{className:"form-part-inner"},i.default.createElement("div",{className:"title"},"在线教育"),i.default.createElement("div",{className:"subtitle"},"Web Demo"),i.default.createElement("div",{className:"box"},i.default.createElement("div",{className:"form-item"},i.default.createElement("label",{className:"form-label"},"请输入账号"),i.default.createElement(l.Input,{value:t.account,onChange:this.changeAccount,domRef:function(t){e.accountInput=t}})),i.default.createElement("div",{className:t.showErrorTip?"form-item form-item-1":"form-item"},i.default.createElement("label",{className:"form-label"},"请输入密码"),i.default.createElement(l.Input,{type:"password",value:t.pwd,onChange:this.changePwd,domRef:function(t){e.pwdInput=t}})),i.default.createElement("div",{className:"form-item f-tar"},i.default.createElement("div",{className:"errortip",hidden:!t.showErrorTip},t.errorTip),i.default.createElement("div",null,i.default.createElement(l.Button,{onClick:this.submit,loading:t.loginLoading,disabled:!t.canLogin},"登录")),i.default.createElement("div",null,i.default.createElement(l.Button,{className:"u-btn-none",onClick:this.regist},"注册")))))),i.default.createElement("div",{className:"banner"}))}}]),t}())||n;t.default=p},643:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=v(a),c=o(19),l=o(145),s=o(23),u=o(105),f=o(11),d=o(13),m=v(o(144)),p=v(o(26)),h=(v(o(25)),v(o(27))),g=v(o(42)),b=v(o(644));function v(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var w=f.StoreNim.state,S=(f.StoreNim,f.StoreChatroom.state),_=f.StoreChatroom,C=f.StoreNetcall.state,j=f.StoreNetcall,E=(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={needShowTip:!0,requesting:!1},n.request=function(e){var t=n.findOwnerIdx();if(-1!=t){var o=S.members[t].account;console.log("当前聊天室主持人：",o),n.setState({requesting:!0}),p.default.sendCustomSysMsg(o,{room_id:S.currChatroomId,command:10}).then(function(){console.log("发送请求连麦消息成功"),j.setShowStatus(1),n.setState({requesting:!1})}).catch(function(e){console.error("发送请求连麦消息失败",e),j.setShowStatus(0),n.setState({requesting:!1})})}else console.error("未找到老师端，老师不在线所致")},n.cancleRequest=function(e){var t=n.findOwnerIdx();if(-1!=t){var o=S.members[t].account;console.log("当前聊天室主持人：",o),n.setState({requesting:!0}),p.default.sendCustomSysMsg(o,{room_id:S.currChatroomId,command:13}).then(function(){console.log("发送请求取消连麦消息成功"),j.setShowStatus(0),n.setState({requesting:!1})}).catch(function(e){console.error("发送请求取消连麦消息失败",e),j.setShowStatus(1),n.setState({requesting:!1})})}else console.error("未找到老师端，老师不在线所致")},n.doStopInteraction=function(){console.log("【停止互动确认弹窗】--\x3e 确定..."),d.Alert.close();var e=n.findOwnerIdx();if(-1!=e){var t=S.members[e].account;console.log("当前聊天室主持人：",t),n.setState({requesting:!0}),p.default.sendCustomSysMsg(t,{room_id:S.currChatroomId,command:13}).then(function(){console.log("【停止连麦】发送请求取消连麦消息成功"),j.setShowStatus(0),n.setState({requesting:!1});var e=C.members.findIndex(function(e){return e.account==w.account});-1==e?console.error("未找到对应DOM节点,无法停止流..."):h.default.stopLocalStream(C.doms[e]),j.delMember(w.account),j.setHasPermission(!1),_.setMemberStatus(w.account,0),g.default.changeRoleToAudience(),h.default.changeRoleToAudience().then(function(){return console.log("==== 切换为观众成功"),h.default.stopMicro()}).then(function(){return console.log("==== 停止麦克风成功"),j.setAudio(!1),h.default.stopCamera()}).then(function(){console.log("==== 停止摄像头成功"),j.setVideo(!1)}).catch(function(e){console.error("停止本地行为失败",e)})}).catch(function(e){console.error("【停止连麦】发送请求取消连麦消息失败",e),n.setState({requesting:!1})})}else console.error("未找到老师端，老师不在线所致")},n.doCancle=function(){console.log("【停止互动确认弹窗】--\x3e 取消..."),d.Alert.close()},n.stopInteraction=function(e){d.Alert.open({title:"提示",msg:'<div class="u-stop-interaction"><i class="u-icon-tip"></i>确定退出互动嘛？</div>',isHtml:!0,btns:[{label:"确定",clsName:"u-btn-smaller f-mgr-10",onClick:function(){n.doStopInteraction()}},{label:"取消",clsName:"u-btn-cancle",onClick:function(){n.doCancle()}}]})},n.closeDeviceDisabledTip=function(){n.setState({needShowTip:!1})},y(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentDidMount",value:function(){(0,d.CheckBroswer)({success:this.init.bind(this)})}},{key:"init",value:function(){j.setShowStatus(0),this.autoLogin()}},{key:"findOwnerIdx",value:function(){return S.members.findIndex(function(e,t){return"owner"==e.type})}},{key:"render",value:function(){var e=this.state;return i.default.createElement("div",null,i.default.createElement(l.Header,{isHome:!1}),i.default.createElement("div",{className:"m-main"},(!C.hasVideo||!C.hasAudio)&&e.needShowTip&&i.default.createElement("div",{id:"device-disabled-tip",className:"u-tip"},i.default.createElement("div",{className:"u-tip-message"},"提示：当前摄像头或话筒不可用 。尝试到浏览器：设置-内容-摄像头\\话筒，删除禁用地址。再刷新页面，获取权限时，点击“同意”。",i.default.createElement("div",{className:"close",onClick:this.closeDeviceDisabledTip}))),i.default.createElement("div",{className:"room-info"},"房间号: ",S.currChatroomId),i.default.createElement("div",{className:"more-opt"},"owner"!=S.type&&!C.hasPermission&&0==C.showStatus&&i.default.createElement(s.Button,{className:"u-btn-longer",onClick:this.request,disabled:e.requesting,loading:e.requesting},"请求互动"),"owner"!=S.type&&!C.hasPermission&&1==C.showStatus&&i.default.createElement(s.Button,{className:"u-btn-longer",onClick:this.cancleRequest,disabled:e.requesting,loading:e.requesting},"取消互动"),"owner"!=S.type&&C.hasPermission&&i.default.createElement(s.Button,{className:"u-btn-longer u-btn-stop",onClick:this.stopInteraction,disabled:e.requesting,loading:e.requesting},"停止互动"),"owner"!=S.type&&!C.hasPermission&&i.default.createElement("div",{className:"tip"},"（注：加入互动后可在白板上与老师画图交流）")),i.default.createElement(u.Whiteboard,null),i.default.createElement("div",{className:"m-netcall"},C.members.map(function(e,t){return i.default.createElement(m.default,{key:t,className:"video-"+(t+1),index:t,self:e.self,account:e.account,offline:e.offline})})),i.default.createElement(u.Chatroom,null)))}}]),t}())||n;E.prototype=Object.assign(E.prototype,b.default),t.default=E},644:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(13),r=s(o(26)),a=s(o(25)),i=s(o(27)),c=s(o(42)),l=o(11);function s(e){return e&&e.__esModule?e:{default:e}}var u=l.StoreNim.state,f=(l.StoreNim,l.StoreChatroom.state),d=l.StoreChatroom,m=l.StoreNetcall.state,p=l.StoreNetcall;t.default={autoLogin:function(){var e=this;if(console.log("检测当前机器的可用设备...."),WebRTC.checkCompatibility().then(function(e){var t=e.Camera,o=e.Microphone;console.log("--- 设备状态",e),p.setHasAudio(o),p.setHasVideo(t)}).catch(function(e){console.error("获取当前机器可用设备时异常: ",e),p.setHasAudio(!1),p.setHasVideo(!1)}),p.settabindex(0),p.setShareStarted(!1),u.account)this.autoLoginChatroom();else{console.log("main:开始自动登录nim过程...");var t=n.Storage.get("account"),o=n.Storage.get("token");if(!t||!o)return console.error("main:自动登录nim:缺少account或token"),void n.Page.to("login");r.default.login(t,o).then(function(){console.log("main:自动登录nim成功"),e.autoLoginChatroom()}).catch(function(e){console.error("main:自动登录nim失败"),n.Page.to("login",e)})}},autoLoginChatroom:function(){var e=this;if(f.currChatroom)return console.log("main:已登录，自动切换到main"),void this.doRtcAndWB();console.log("main:开始自动登录chatroom过程...");var t=n.Storage.get("roomId");if(!t)return console.error("main:自动登录chatroom失败：缺少roomid，回到home"),void n.Page.to("home");a.default.login(t).then(function(){console.log("main:自动登录chatroom成功"),(0,n.Toast)({time:15,msg:"检测到你进行了刷新操作，如果出现听不到对端声音的问题，可点击后修复"});var t=document.createElement("button");t.innerText="点击修复",t.classList="u-btn u-btn-smaller",t.style.marginLeft="20px",t.style.height="22px",t.style.lineHeight="22px",t.id="replayAudio",document.querySelector(".u-tip-message").appendChild(t),document.getElementById("replayAudio").addEventListener("click",function(){m.members.forEach(function(e){0!==e.account.length&&i.default.startPlayRemoteAudio(e.account)})}),setTimeout(function(){document.querySelector(".u-tip-message").removeChild(document.querySelector("#replayAudio"))},15e3),e.doRtcAndWB()}).catch(function(e){console.error("main:自动登录chatroom失败",e),n.Page.to("home")})},doRtcAndWB:function(){p.addDom(document.getElementById("video-1")),p.addDom(document.getElementById("video-2")),p.addDom(document.getElementById("video-3")),p.addDom(document.getElementById("video-4")),this.autoLoginWebRtc(),this.autoLoginWhiteBoard()},autoLoginWebRtc:function(){var e=this;m.webrtc||i.default.initSDK(),a.default.getChatroomMembersInfo(u.account).then(function(t){console.log("自动登录RTC前，预加载当前用户的角色：",t),d.setType(t.members[0].type);var o="owner"==t.members[0].type;e.joinChannelRtc(f.currChatroomId,o)}).catch(function(e){console.error("获取成员信息失败...",e)})},joinChannelRtc:function(e,t){var o=this;console.log("===  开始加入RTC房间"),i.default.joinChannel(f.currChatroomId).then(function(e){console.log("webrtc 加入房间成功",e),1==t?o.doRtcTask4Teacher():o.doRtcTask4Student()}).catch(function(e){e&&e.event&&e.event.event&&e.event.event.code&&404==e.event.event.code?1==t?(console.log("老师端，RTC房间不存在，主动创建..."),o.createChannelRtc(f.currChatroomId)):console.error("webrtc 房间不存在",e):(console.error("webrtc 加入房间失败: ",e),"已经加入房间"==e&&(1==t?o.doRtcTask4Teacher():o.doRtcTask4Student()))})},autoLoginWhiteBoard:function(){l.StoreWhiteBoard.whiteboard||c.default.initSDK();var e=n.Storage.get("isTeacher");this.joinChannelWb(f.currChatroomId,e)},joinChannelWb:function(e,t){var o=this;c.default.joinChannel(f.currChatroomId).then(function(e){console.log("whiteboard 加入房间成功",e),1==t?o.doWbTask4Teacher():o.doWbTask4Student()}).catch(function(e){e&&e.event&&e.event.code&&404==e.event.code?1==t?(console.log("老师端，WHITEBOARD房间不存在，主动创建..."),o.createChannelWb(f.currChatroomId)):console.error("whiteboard 房间不存在",e):(console.error("whiteboard 加入房间失败: ",e),"已经加入房间"==e&&(1==t?o.doWbTask4Teacher():o.doWbTask4Student()))})},doRtcTask4Teacher:function(){console.log("老师处理RTC..."),p.addMember({account:u.account,self:!0},!0,!1),p.setHasPermission(!0),i.default.changeRoleToPlayer(),i.default.startRtc().then(function(){m.hasAudio&&m.audio&&i.default.startMicro().then(function(){console.log("===麦克风启动成功")}).catch(function(e){console.error("===麦克风启动失败",e),"NotAllowedError"==e&&p.setHasAudio(!1)}),m.hasVideo&&m.video&&i.default.startCamera().then(function(){console.log("===摄像头启动成功");var e=m.doms[0];console.log("当前人员加入节点：",e),i.default.startLocalStream(e),i.default.setVideoViewSize()}).catch(function(e){console.error("===摄像头启动失败",e),"NotAllowedError"==e&&p.setHasVideo(!1)})}).catch(function(e){console.error(e),console.log("startRtc出错")})},doRtcTask4Student:function(){console.log("学生处理RTC..."),i.default.changeRoleToAudience(),i.default.startRtc()},doWbTask4Teacher:function(){c.default.changeRoleToPlayer(),c.default.setColor("#000")},doWbTask4Student:function(){c.default.changeRoleToAudience(),c.default.setColor("#35CBFF")},createChannelRtc:function(e){var t=this;i.default.createChannel(e).then(function(o){console.log("webrtc 创建房间成功"),p.setFromCreate(!0),t.joinChannelRtc(e,!0)}).catch(function(e){console.error("webrtc 创建房间失败",e)})},createChannelWb:function(e){var t=this;c.default.createChannel(e).then(function(o){console.log("whiteboard 创建房间成功"),t.joinChannelWb(e,!0)}).catch(function(e){console.error("whiteboard 创建房间失败")})}}},645:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=o(19),l=(o(145),o(23)),s=o(13),u=o(11),f=d(o(26));function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={nickname:"",username:"",password:"",errorTip:"",showErrorTip:!1,canRegist:!1,hasUsername:!1,hasNickname:!1,hasPassword:!1,registLoading:!1},n.changeUsername=function(e){var t=e.target.value;s.Valid.isBlank(t)?n.setState({hasUsername:!1,username:"",canRegist:!1}):n.setState(function(e,o){return{username:t,hasUsername:!0,canRegist:e.hasNickname&&e.hasPassword}})},n.changeNickname=function(e){var t=e.target.value;s.Valid.isBlank(t)?n.setState({hasNickname:!1,nickname:"",canRegist:!1}):n.setState(function(e,o){return{nickname:t,hasNickname:!0,canRegist:e.hasUsername&&e.hasPassword}})},n.changePassword=function(e){var t=e.target.value;s.Valid.isBlank(t)?n.setState({hasPassword:!1,password:"",canRegist:!1}):n.setState(function(e,o){return{password:t,hasPassword:!0,canRegist:e.hasUsername&&e.hasNickname}})},n.submit=function(e){if(n.state.canRegist&&!n.state.registLoading){if(s.Valid.isBlank(n.state.username))return n.setState({showErrorTip:!0,errorTip:"请输入账号"}),void n.usernameInput.focus();if(!n.validateFormat("username",n.state.username))return n.setState({showErrorTip:!0,errorTip:"账号限字母或数字"}),void n.usernameInput.focus();if(s.Valid.isBlank(n.state.nickname))return n.setState({showErrorTip:!0,errorTip:"请输入昵称"}),void n.nicknameInput.focus();if(!n.validateFormat("nickname",n.state.nickname))return n.setState({showErrorTip:!0,errorTip:"昵称限汉字、字母或数字"}),void n.nicknameInput.focus();if(s.Valid.isBlank(n.state.password))return n.setState({showErrorTip:!0,errorTip:"请输入密码"}),void n.passwordInput.focus();if(n.state.password.length<6||!n.validateFormat("password",n.state.password))return n.setState({showErrorTip:!0,errorTip:"密码限6～20位字母或数字"}),void n.passwordInput.focus();n.setState({showErrorTip:!1,errorTip:"",registLoading:!0}),n.requestRegist({username:n.state.username,nickname:n.state.nickname,password:n.state.password})}else console.log("不可点击注册或正在注册中...")},m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentDidMount",value:function(){(0,s.CheckBroswer)({success:this.init.bind(this)})}},{key:"init",value:function(){this.usernameInput.focus(),u.StoreNim.state.account&&s.Page.to("home")}},{key:"login",value:function(){s.Page.to("login")}},{key:"validateFormat",value:function(e,t){switch(e){case"username":return/^[0-9A-Za-z]{1,20}$/.test(t);case"nickname":return/^[\u4e00-\u9fa50-9A-Za-z]{1,10}$/.test(t);case"password":return/^[0-9A-Za-z]{6,20}$/.test(t);default:return!0}}},{key:"requestRegist",value:function(e){var t=this;f.default.regist(e).then(function(){console.log("注册成功"),t.requestLogin({account:t.state.username,pwd:t.state.password})}).catch(function(e){console.error("注册失败",e),t.usernameInput.focus(),t.setState({showErrorTip:!0,errorTip:e,registLoading:!1})})}},{key:"requestLogin",value:function(e){var t=this,o=e.account,n=(0,s.MD5)(e.pwd);s.Storage.set("account",o),s.Storage.set("token",n),f.default.login(o,n).then(function(){console.log("登录成功"),s.Page.to("home")}).catch(function(e){console.error("登录成功",e),t.setState({showErrorTip:!0,errorTip:e,registLoading:!1})})}},{key:"render",value:function(){var e=this;console.log("render regist");var t=this.state;return i.default.createElement("div",{className:"m-login"},i.default.createElement("div",{className:"form-part"},i.default.createElement("div",{className:"form-part-inner"},i.default.createElement("div",{className:"title"},"在线教育"),i.default.createElement("div",{className:"subtitle"},"Web Demo"),i.default.createElement("div",{className:"box box-regist"},i.default.createElement("div",{className:"form-item"},i.default.createElement("label",{className:"form-label"},"账号:限20位字母或数字"),i.default.createElement(l.Input,{value:t.username,onChange:this.changeUsername,maxLength:20,domRef:function(t){e.usernameInput=t}})),i.default.createElement("div",{className:"form-item"},i.default.createElement("label",{className:"form-label"},"昵称:限10位汉字、字母或数字"),i.default.createElement(l.Input,{value:t.nickname,onChange:this.changeNickname,maxLength:10,domRef:function(t){e.nicknameInput=t}})),i.default.createElement("div",{className:t.showErrorTip?"form-item form-item-1":"form-item"},i.default.createElement("label",{className:"form-label"},"密码:6-20位字母或数字"),i.default.createElement(l.Input,{type:"password",value:t.password,onChange:this.changePassword,maxLength:20,domRef:function(t){e.passwordInput=t}})),i.default.createElement("div",{className:"form-item f-tar"},i.default.createElement("div",{className:"errortip",hidden:!t.showErrorTip},t.errorTip),i.default.createElement("div",null,i.default.createElement(l.Button,{onClick:this.submit,loading:t.registLoading,disabled:!t.canRegist},"注册")),i.default.createElement("div",null,i.default.createElement("a",{href:"javascript:void(0);",className:"gotoLogin",onClick:this.login},"已有账号?直接登录")))))),i.default.createElement("div",{className:"banner"}))}}]),t}())||n;t.default=p},75:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={appkey:"1ee5a51b7d008254cd73b1d4369a9494",url:"https://app.netease.im",resourceUrl:"http://yx-web.nos.netease.com/webdoc/h5",emojiBaseUrl:"http://yx-web.nosdn.127.net/webdoc/h5/emoji"}}});